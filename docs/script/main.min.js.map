{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/ts/gl-utils/gl-resource.ts","webpack:///./src/ts/gl-utils/gl-canvas.ts","webpack:///./src/ts/gl-utils/fbo.ts","webpack:///./src/ts/parameters.ts","webpack:///./src/ts/main.ts","webpack:///./src/ts/gl-utils/viewport.ts","webpack:///./src/ts/automaton-2D.ts","webpack:///./src/ts/gl-utils/shader-manager.ts","webpack:///./src/ts/gl-utils/shader.ts","webpack:///./src/ts/gl-utils/shader-sources.ts","webpack:///./src/ts/gl-utils/vbo.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","GLResource","gl","this","_gl","default","initGL","adjustSize","flags","setError","message","Page","Demopage","setErrorMessage","canvas","Canvas","getCanvas","getContext","disable","CULL_FACE","DEPTH_TEST","BLEND","clearColor","hidpi","cssPixel","window","devicePixelRatio","width","Math","floor","clientWidth","height","clientHeight","extendStatics","__extends","b","setPrototypeOf","__proto__","Array","__","constructor","__importDefault","mod","FBO","_super","_this","id","createFramebuffer","bindDefault","viewport","bindFramebuffer","FRAMEBUFFER","drawingBufferWidth","drawingBufferHeight","left","lower","colorBuffers","depthBuffer","length","framebufferTexture2D","TEXTURE_2D","bindRenderbuffer","RENDERBUFFER","framebufferRenderbuffer","DEPTH_ATTACHMENT","freeGLResources","deleteFramebuffer","Rule","rules","DEATH","ALIVE","BIRTH","updateRuleControl","Tabs","setValues","autorun","rulesObservers","addEventListener","_loop_1","addObserver","values","previous","indexOf","forEach","callback","speed","Checkbox","checked","isChecked","updateWaitTime","Range","newValue","getValue","nextStepObservers","Button","_i","nextStepObservers_1","observer","persistence","resetObservers","resetObservers_1","scale","exactScale","persistenceObservers","persistenceScale","persistenceObservers_1","scaleObservers","Observers","mouseWheel","push","delta","zoomCenter","min","max","newScale","round","getMousePosition","scaleObservers_1","setIndicatorsVisibility","Parameters","set","ar","setChecked","configurable","setValue","__createBinding","k","k2","undefined","__setModuleDefault","v","__importStar","result","fbo_1","GlCanvas","gl_canvas_1","viewport_1","automaton_2D_1","parameters_1","alpha","preserveDrawingBuffer","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","showLoader","needToAdjustSize","canvasResize","automaton","lastIteration","iteration","setInterval","setIndicatorText","forceUpdate","firstDraw","lastUpdate","requestAnimationFrame","mainLoop","time","update","needToUpdate","needToRedraw","setFullCanvas","draw","main","Viewport","gl_resource_1","ShaderManager","vbo_1","Automaton2D","_FBO","_vbo","createQuad","initializeTexturesForCanvas","canvasSize","getSize","initializeTextures","recomputeVisibleSubTexture","_needToRecomputeShader","_mustClear","_textures","_visibleSubTexture","mouseDrag","dX","dY","_needToRedraw","previousScale","buildShader","fragmentFilename","vertexFilename","injected","shader","_displayShader","a","VBO","u","_updateShader","freeTextures","recomputeUpdateShader","current","_currentIndex","next","_textureSize","use","bindUniformsAndAttributes","drawArrays","TRIANGLE_STRIP","_iteration","_gridSize","enable","generateShaderRules","generateRuleBlock","starting","ending","rule","rangeCheck","currentRule","from","deleteTexture","upperPowerOfTwo","pow","ceil","log","LOG2E","physicalWidth","physicalHeight","data","Uint8Array","random","createTexture","bindTexture","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","deleteShader","registerShader","getShader","shader_1","ShaderSources","cachedShaders","infos","sourcesPending","sourcesFailed","loadedSource","success","processSource","source","replace","match","vert","getSource","frag","processedVert","processedFrag","loadSource","callAndClearCallbacks","cached","_a","callbacks","cachedCallback","failed","pending","cached_1","builtShader","notImplemented","location","alert","types","str","binder","uniform2fv","uniform3fv","uniform4fv","uniform2iv","uniform3iv","uniform4iv","uniform1i","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","unitNb","activeTexture","TEXTURE_CUBE_MAP","isArray","uniform1iv","uniform1fv","uniform1f","ShaderProgram","vertexSource","fragmentSource","createShader","type","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","uCount","aCount","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","introspection","getProgramInfoLog","deleteProgram","useProgram","bindUniforms","currTextureUnitNb","keys","uName","uniform","loc","bindAttributes","aName","attribute","ACTIVE_UNIFORMS","getActiveUniform","name_1","getUniformLocation","size","ACTIVE_ATTRIBUTES","getActiveAttrib","name_2","getAttribLocation","cachedSources","filename","text","xhr_1","XMLHttpRequest","open","onload","readyState","status","responseText","statusText","onerror","send","array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","normalize","stride","offset","minX","minY","maxX","maxY","Float32Array","FLOAT","deleteBuffer","enableVertexAttribArray","vertexAttribPointer"],"mappings":"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","file":"main.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar GLResource = (function () {\r\n    function GLResource(gl) {\r\n        this._gl = gl;\r\n    }\r\n    GLResource.prototype.gl = function () {\r\n        return this._gl;\r\n    };\r\n    return GLResource;\r\n}());\r\nexports.default = GLResource;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.gl = exports.initGL = exports.adjustSize = void 0;\r\nrequire(\"../page-interface-generated\");\r\nvar gl = null;\r\nexports.gl = gl;\r\nfunction initGL(flags) {\r\n    function setError(message) {\r\n        Page.Demopage.setErrorMessage(\"webgl-support\", message);\r\n    }\r\n    var canvas = Page.Canvas.getCanvas();\r\n    exports.gl = gl = canvas.getContext(\"webgl\", flags);\r\n    if (gl == null) {\r\n        exports.gl = gl = canvas.getContext(\"experimental-webgl\", flags);\r\n        if (gl == null) {\r\n            setError(\"Your browser or device does not seem to support WebGL.\");\r\n            return false;\r\n        }\r\n        setError(\"Your browser or device only supports experimental WebGL.\\n\" +\r\n            \"The simulation may not run as expected.\");\r\n    }\r\n    gl.disable(gl.CULL_FACE);\r\n    gl.disable(gl.DEPTH_TEST);\r\n    gl.disable(gl.BLEND);\r\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n    return true;\r\n}\r\nexports.initGL = initGL;\r\nfunction adjustSize(hidpi) {\r\n    if (hidpi === void 0) { hidpi = false; }\r\n    var cssPixel = (hidpi) ? window.devicePixelRatio : 1;\r\n    var canvas = gl.canvas;\r\n    var width = Math.floor(canvas.clientWidth * cssPixel);\r\n    var height = Math.floor(canvas.clientHeight * cssPixel);\r\n    if (canvas.width !== width || canvas.height !== height) {\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n    }\r\n}\r\nexports.adjustSize = adjustSize;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\r\nvar FBO = (function (_super) {\r\n    __extends(FBO, _super);\r\n    function FBO(gl, width, height) {\r\n        var _this = _super.call(this, gl) || this;\r\n        _this.id = gl.createFramebuffer();\r\n        _this.width = width;\r\n        _this.height = height;\r\n        return _this;\r\n    }\r\n    FBO.bindDefault = function (gl, viewport) {\r\n        if (viewport === void 0) { viewport = null; }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        if (viewport === null) {\r\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n        }\r\n        else {\r\n            gl.viewport(viewport.left, viewport.lower, viewport.width, viewport.height);\r\n        }\r\n    };\r\n    FBO.prototype.bind = function (colorBuffers, depthBuffer) {\r\n        if (depthBuffer === void 0) { depthBuffer = null; }\r\n        var gl = _super.prototype.gl.call(this);\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.id);\r\n        gl.viewport(0, 0, this.width, this.height);\r\n        for (var i = 0; i < colorBuffers.length; ++i) {\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl[\"COLOR_ATTACHMENT\" + i], gl.TEXTURE_2D, colorBuffers[i], 0);\r\n        }\r\n        if (depthBuffer) {\r\n            gl.bindRenderbuffer(gl.RENDERBUFFER, depthBuffer);\r\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, depthBuffer);\r\n        }\r\n    };\r\n    FBO.prototype.freeGLResources = function () {\r\n        _super.prototype.gl.call(this).deleteFramebuffer(this.id);\r\n        this.id = null;\r\n    };\r\n    return FBO;\r\n}(gl_resource_1.default));\r\nexports.default = FBO;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"./page-interface-generated\");\r\nvar Rule;\r\n(function (Rule) {\r\n    Rule[\"DEATH\"] = \"death\";\r\n    Rule[\"ALIVE\"] = \"alive\";\r\n    Rule[\"BIRTH\"] = \"birth\";\r\n})(Rule || (Rule = {}));\r\nvar rules = [\r\n    Rule.DEATH,\r\n    Rule.DEATH,\r\n    Rule.ALIVE,\r\n    Rule.BIRTH,\r\n    Rule.DEATH,\r\n    Rule.DEATH,\r\n    Rule.DEATH,\r\n    Rule.DEATH,\r\n    Rule.DEATH,\r\n];\r\nfunction updateRuleControl(id) {\r\n    if (rules[id] === Rule.DEATH) {\r\n        Page.Tabs.setValues(\"neighbours-tabs-\" + id, [\"death\"]);\r\n    }\r\n    else if (rules[id] === Rule.ALIVE) {\r\n        Page.Tabs.setValues(\"neighbours-tabs-\" + id, [\"alive\"]);\r\n    }\r\n    else if (rules[id] === Rule.BIRTH) {\r\n        Page.Tabs.setValues(\"neighbours-tabs-\" + id, [\"alive\", \"birth\"]);\r\n    }\r\n}\r\nfor (var i = 0; i < 9; ++i) {\r\n    updateRuleControl(i);\r\n}\r\nvar rulesObservers = [];\r\nwindow.addEventListener(\"load\", function () {\r\n    var _loop_1 = function (i) {\r\n        Page.Tabs.addObserver(\"neighbours-tabs-\" + i, function (values) {\r\n            var previous = rules[i];\r\n            if (rules[i] !== Rule.DEATH && values.indexOf(Rule.DEATH) >= 0) {\r\n                rules[i] = Rule.DEATH;\r\n            }\r\n            else if (rules[i] !== Rule.ALIVE && values.indexOf(Rule.ALIVE) >= 0) {\r\n                rules[i] = Rule.ALIVE;\r\n            }\r\n            else if (rules[i] !== Rule.BIRTH && values.indexOf(Rule.BIRTH) >= 0) {\r\n                rules[i] = Rule.BIRTH;\r\n            }\r\n            updateRuleControl(i);\r\n            if (previous !== rules[i]) {\r\n                rulesObservers.forEach(function (callback) { return callback(); });\r\n            }\r\n        });\r\n    };\r\n    for (var i = 0; i < 9; ++i) {\r\n        _loop_1(i);\r\n    }\r\n});\r\nvar autorun;\r\nvar AUTORUN_CONTROL_ID = \"autorun-checkbox-id\";\r\nPage.Checkbox.addObserver(AUTORUN_CONTROL_ID, function (checked) {\r\n    autorun = checked;\r\n});\r\nautorun = Page.Checkbox.isChecked(AUTORUN_CONTROL_ID);\r\nvar speed;\r\nvar updateWaitTime = [1000 / 1, 1000 / 2, 1000 / 5, 1000 / 11, 1000 / 31, 0];\r\nvar SPEED_CONTROL_ID = \"speed-range-id\";\r\nPage.Range.addObserver(SPEED_CONTROL_ID, function (newValue) {\r\n    speed = newValue;\r\n});\r\nspeed = Page.Range.getValue(SPEED_CONTROL_ID);\r\nvar NEXT_STEP_CONTROL_ID = \"next-button-id\";\r\nvar nextStepObservers = [];\r\nPage.Button.addObserver(NEXT_STEP_CONTROL_ID, function () {\r\n    for (var _i = 0, nextStepObservers_1 = nextStepObservers; _i < nextStepObservers_1.length; _i++) {\r\n        var observer = nextStepObservers_1[_i];\r\n        observer();\r\n    }\r\n});\r\nvar RESET_CONTROL_ID = \"reset-button-id\";\r\nvar resetObservers = [];\r\nPage.Button.addObserver(RESET_CONTROL_ID, function () {\r\n    for (var _i = 0, resetObservers_1 = resetObservers; _i < resetObservers_1.length; _i++) {\r\n        var observer = resetObservers_1[_i];\r\n        observer();\r\n    }\r\n});\r\nvar persistence;\r\nvar persistenceObservers = [];\r\nvar persistenceScale = [0, .6, .7, .8, .9];\r\nvar PERSISTENCE_CONTROL_ID = \"persistence-range-id\";\r\nPage.Range.addObserver(PERSISTENCE_CONTROL_ID, function (newValue) {\r\n    persistence = newValue;\r\n    for (var _i = 0, persistenceObservers_1 = persistenceObservers; _i < persistenceObservers_1.length; _i++) {\r\n        var observer = persistenceObservers_1[_i];\r\n        observer(persistence);\r\n    }\r\n});\r\npersistence = Page.Range.getValue(PERSISTENCE_CONTROL_ID);\r\nvar scale;\r\nvar exactScale;\r\nvar MIN_SCALE = 1;\r\nvar MAX_SCALE = 10;\r\nvar scaleObservers = [];\r\nPage.Canvas.Observers.mouseWheel.push(function (delta, zoomCenter) {\r\n    exactScale = Math.min(MAX_SCALE, Math.max(MIN_SCALE, exactScale - delta));\r\n    var newScale = Math.round(exactScale);\r\n    if (newScale !== scale) {\r\n        scale = newScale;\r\n        if (!zoomCenter) {\r\n            zoomCenter = Page.Canvas.getMousePosition();\r\n        }\r\n        for (var _i = 0, scaleObservers_1 = scaleObservers; _i < scaleObservers_1.length; _i++) {\r\n            var observer = scaleObservers_1[_i];\r\n            observer(scale, zoomCenter);\r\n        }\r\n    }\r\n});\r\nscale = MIN_SCALE;\r\nexactScale = scale;\r\nvar INDICATORS_CONTROL_ID = \"indicators-checkbox-id\";\r\nPage.Checkbox.addObserver(INDICATORS_CONTROL_ID, function (checked) {\r\n    Page.Canvas.setIndicatorsVisibility(checked);\r\n});\r\nvar Parameters = (function () {\r\n    function Parameters() {\r\n    }\r\n    Object.defineProperty(Parameters, \"autorun\", {\r\n        get: function () {\r\n            return autorun;\r\n        },\r\n        set: function (ar) {\r\n            autorun = ar;\r\n            Page.Checkbox.setChecked(AUTORUN_CONTROL_ID, ar);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"updateWaitTime\", {\r\n        get: function () {\r\n            return updateWaitTime[speed - 1];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"nextStepObservers\", {\r\n        get: function () {\r\n            return nextStepObservers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"resetObservers\", {\r\n        get: function () {\r\n            return resetObservers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"scale\", {\r\n        get: function () {\r\n            return scale;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"scaleObservers\", {\r\n        get: function () {\r\n            return scaleObservers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"persistence\", {\r\n        get: function () {\r\n            return persistenceScale[persistence];\r\n        },\r\n        set: function (newValue) {\r\n            Page.Range.setValue(PERSISTENCE_CONTROL_ID, newValue);\r\n            persistence = Page.Range.getValue(PERSISTENCE_CONTROL_ID);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"persistenceObservers\", {\r\n        get: function () {\r\n            return persistenceObservers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"rules\", {\r\n        get: function () {\r\n            return rules;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Parameters, \"rulesObservers\", {\r\n        get: function () {\r\n            return rulesObservers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Parameters;\r\n}());\r\nexports.default = Parameters;\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\r\nvar GlCanvas = __importStar(require(\"./gl-utils/gl-canvas\"));\r\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\r\nvar viewport_1 = __importDefault(require(\"./gl-utils/viewport\"));\r\nvar automaton_2D_1 = __importDefault(require(\"./automaton-2D\"));\r\nvar parameters_1 = __importDefault(require(\"./parameters\"));\r\nrequire(\"./page-interface-generated\");\r\nfunction main() {\r\n    var glParams = {\r\n        alpha: false,\r\n        preserveDrawingBuffer: true,\r\n    };\r\n    if (!GlCanvas.initGL(glParams)) {\r\n        return;\r\n    }\r\n    gl_canvas_1.gl.blendFunc(gl_canvas_1.gl.ONE, gl_canvas_1.gl.ONE_MINUS_SRC_ALPHA);\r\n    Page.Canvas.showLoader(true);\r\n    var needToAdjustSize = true;\r\n    Page.Canvas.Observers.canvasResize.push(function () { return needToAdjustSize = true; });\r\n    parameters_1.default.autorun = true;\r\n    parameters_1.default.persistence = 0;\r\n    var automaton = new automaton_2D_1.default();\r\n    var lastIteration = automaton.iteration;\r\n    function updateIterationPerSecIndicator() {\r\n        Page.Canvas.setIndicatorText(\"iterations-per-sec\", \"\" + (automaton.iteration - lastIteration));\r\n        lastIteration = automaton.iteration;\r\n    }\r\n    window.setInterval(updateIterationPerSecIndicator, 1000);\r\n    function updateIterationIndicator() {\r\n        Page.Canvas.setIndicatorText(\"iteration\", \"\" + automaton.iteration);\r\n    }\r\n    window.setInterval(updateIterationIndicator, 50);\r\n    var forceUpdate = false;\r\n    parameters_1.default.nextStepObservers.push(function () { return forceUpdate = true; });\r\n    var firstDraw = true;\r\n    var lastUpdate = 0;\r\n    function mainLoop(time) {\r\n        var update = automaton.needToUpdate || forceUpdate ||\r\n            (parameters_1.default.autorun && (time - lastUpdate > parameters_1.default.updateWaitTime));\r\n        if (update) {\r\n            lastUpdate = time;\r\n            automaton.update();\r\n            forceUpdate = false;\r\n        }\r\n        if (update || automaton.needToRedraw) {\r\n            fbo_1.default.bindDefault(gl_canvas_1.gl);\r\n            if (needToAdjustSize) {\r\n                GlCanvas.adjustSize();\r\n                needToAdjustSize = false;\r\n            }\r\n            viewport_1.default.setFullCanvas(gl_canvas_1.gl);\r\n            automaton.draw();\r\n            if (firstDraw) {\r\n                firstDraw = false;\r\n                Page.Canvas.showLoader(false);\r\n            }\r\n        }\r\n        requestAnimationFrame(mainLoop);\r\n    }\r\n    requestAnimationFrame(mainLoop);\r\n}\r\nmain();\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Viewport = (function () {\r\n    function Viewport(left, lower, width, height) {\r\n        this.left = left;\r\n        this.lower = lower;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    Viewport.setFullCanvas = function (gl) {\r\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n    };\r\n    Viewport.prototype.set = function (gl) {\r\n        gl.viewport(this.lower, this.left, this.width, this.height);\r\n    };\r\n    return Viewport;\r\n}());\r\nexports.default = Viewport;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\r\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\r\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\r\nvar ShaderManager = __importStar(require(\"./gl-utils/shader-manager\"));\r\nvar vbo_1 = __importDefault(require(\"./gl-utils/vbo\"));\r\nvar parameters_1 = __importDefault(require(\"./parameters\"));\r\nrequire(\"./page-interface-generated\");\r\nvar Automaton2D = (function (_super) {\r\n    __extends(Automaton2D, _super);\r\n    function Automaton2D() {\r\n        var _this = _super.call(this, gl_canvas_1.gl) || this;\r\n        _this._FBO = new fbo_1.default(gl_canvas_1.gl, 512, 512);\r\n        _this._vbo = vbo_1.default.createQuad(gl_canvas_1.gl, -1, -1, 1, 1);\r\n        var initializeTexturesForCanvas = function () {\r\n            var canvasSize = Page.Canvas.getSize();\r\n            _this.initializeTextures(canvasSize[0], canvasSize[1]);\r\n            _this.recomputeVisibleSubTexture();\r\n        };\r\n        _this._needToRecomputeShader = true;\r\n        _this._mustClear = true;\r\n        _this._textures = [null, null];\r\n        _this._visibleSubTexture = [0, 0, 1, 1];\r\n        initializeTexturesForCanvas();\r\n        Page.Canvas.Observers.mouseDrag.push(function (dX, dY) {\r\n            _this._visibleSubTexture[0] -= dX * _this._visibleSubTexture[2];\r\n            _this._visibleSubTexture[1] -= dY * _this._visibleSubTexture[3];\r\n            _this.recomputeVisibleSubTexture();\r\n            _this._needToRedraw = true;\r\n            _this._mustClear = true;\r\n        });\r\n        Page.Canvas.Observers.canvasResize.push(initializeTexturesForCanvas);\r\n        parameters_1.default.resetObservers.push(initializeTexturesForCanvas);\r\n        parameters_1.default.rulesObservers.push(function () { return _this._needToRecomputeShader = true; });\r\n        var previousScale = parameters_1.default.scale;\r\n        parameters_1.default.scaleObservers.push(function (newScale, zoomCenter) {\r\n            _this._needToRedraw = true;\r\n            _this._mustClear = true;\r\n            _this._visibleSubTexture[0] += zoomCenter[0] * (1 - previousScale / newScale) * _this._visibleSubTexture[2];\r\n            _this._visibleSubTexture[1] += zoomCenter[1] * (1 - previousScale / newScale) * _this._visibleSubTexture[3];\r\n            previousScale = newScale;\r\n            _this.recomputeVisibleSubTexture();\r\n        });\r\n        ShaderManager.buildShader({\r\n            fragmentFilename: \"display-2D.frag\",\r\n            vertexFilename: \"display-2D.vert\",\r\n            injected: {},\r\n        }, function (shader) {\r\n            if (shader !== null) {\r\n                _this._displayShader = shader;\r\n                _this._displayShader.a[\"aCorner\"].VBO = _this._vbo;\r\n                _this._displayShader.u[\"uSubTexture\"].value = _this._visibleSubTexture;\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    Automaton2D.prototype.freeGLResources = function () {\r\n        if (this._FBO) {\r\n            this._FBO.freeGLResources();\r\n        }\r\n        if (this._vbo) {\r\n            this._vbo.freeGLResources();\r\n            this._vbo = null;\r\n        }\r\n        if (this._displayShader) {\r\n            this._displayShader.freeGLResources();\r\n            this._displayShader = null;\r\n        }\r\n        if (this._updateShader) {\r\n            this._updateShader.freeGLResources();\r\n            this._updateShader = null;\r\n        }\r\n        this.freeTextures();\r\n    };\r\n    Automaton2D.prototype.update = function () {\r\n        if (this._needToRecomputeShader) {\r\n            this.recomputeUpdateShader();\r\n        }\r\n        var shader = this._updateShader;\r\n        if (shader) {\r\n            var current = this._textures[this._currentIndex];\r\n            var next = this._textures[(this._currentIndex + 1) % 2];\r\n            this._FBO.bind([next]);\r\n            shader.u[\"uPrevious\"].value = current;\r\n            shader.u[\"uPhysicalCellSize\"].value = [1 / this._textureSize[0], 1 / this._textureSize[1]];\r\n            shader.use();\r\n            shader.bindUniformsAndAttributes();\r\n            gl_canvas_1.gl.disable(gl_canvas_1.gl.BLEND);\r\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\r\n            this._currentIndex = (this._currentIndex + 1) % 2;\r\n            this._iteration++;\r\n        }\r\n    };\r\n    Automaton2D.prototype.draw = function () {\r\n        var shader = this._displayShader;\r\n        if (shader) {\r\n            shader.u[\"uClearFactor\"].value = (this._mustClear) ? 1 : 1 - parameters_1.default.persistence;\r\n            shader.u[\"uTexture\"].value = this._textures[this._currentIndex];\r\n            shader.u[\"uGridSize\"].value = this._gridSize;\r\n            shader.use();\r\n            shader.bindUniformsAndAttributes();\r\n            gl_canvas_1.gl.enable(gl_canvas_1.gl.BLEND);\r\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\r\n            this._needToRedraw = false;\r\n            this._mustClear = false;\r\n        }\r\n    };\r\n    Object.defineProperty(Automaton2D.prototype, \"iteration\", {\r\n        get: function () {\r\n            return this._iteration;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Automaton2D.prototype, \"needToRedraw\", {\r\n        get: function () {\r\n            return this._needToRedraw;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Automaton2D.prototype, \"needToUpdate\", {\r\n        get: function () {\r\n            return this._needToRecomputeShader;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Automaton2D.prototype.recomputeUpdateShader = function () {\r\n        var _this = this;\r\n        ShaderManager.buildShader({\r\n            fragmentFilename: \"update-2D.frag\",\r\n            vertexFilename: \"update-2D.vert\",\r\n            injected: { rules: this.generateShaderRules() },\r\n        }, function (shader) {\r\n            if (shader !== null) {\r\n                if (_this._updateShader) {\r\n                    _this._updateShader.freeGLResources();\r\n                }\r\n                _this._updateShader = shader;\r\n                _this._updateShader.a[\"aCorner\"].VBO = _this._vbo;\r\n            }\r\n        });\r\n        this._needToRecomputeShader = false;\r\n    };\r\n    Automaton2D.prototype.generateShaderRules = function () {\r\n        function generateRuleBlock(starting, ending, rule) {\r\n            if (rule !== \"alive\") {\r\n                var operation = (rule === \"death\") ? \" -= \" : \" += \";\r\n                var rangeCheck = void 0;\r\n                if (starting === 0) {\r\n                    rangeCheck = \"step(N, \" + (ending + .5) + \")\";\r\n                    if (ending === 8) {\r\n                        rangeCheck = \"1.0\";\r\n                    }\r\n                }\r\n                else if (ending === 8) {\r\n                    rangeCheck = \"step(\" + (starting - .5) + \", N)\";\r\n                }\r\n                else {\r\n                    rangeCheck = \"step(\" + (starting - .5) + \", N) * step(N, \" + (ending + .5) + \")\";\r\n                }\r\n                return \"currentState\" + operation + rangeCheck + \";\\n\";\r\n            }\r\n            return \"\";\r\n        }\r\n        var result = \"\";\r\n        var rules = parameters_1.default.rules;\r\n        var currentRule = rules[0];\r\n        var from = 0;\r\n        for (var i = 1; i < 9; ++i) {\r\n            if (rules[i] !== currentRule) {\r\n                result += generateRuleBlock(from, i - 1, currentRule);\r\n                currentRule = rules[i];\r\n                from = i;\r\n            }\r\n        }\r\n        result += generateRuleBlock(from, 8, currentRule);\r\n        return result;\r\n    };\r\n    Automaton2D.prototype.recomputeVisibleSubTexture = function () {\r\n        var canvasSize = Page.Canvas.getSize();\r\n        this._visibleSubTexture[2] = canvasSize[0] / this._gridSize[0] / parameters_1.default.scale;\r\n        this._visibleSubTexture[3] = canvasSize[1] / this._gridSize[1] / parameters_1.default.scale;\r\n        for (var i = 0; i < 2; ++i) {\r\n            this._visibleSubTexture[i] -= Math.min(0, this._visibleSubTexture[i]);\r\n            this._visibleSubTexture[i] -= Math.max(0, this._visibleSubTexture[i] + this._visibleSubTexture[i + 2] - 1);\r\n        }\r\n    };\r\n    Automaton2D.prototype.freeTextures = function () {\r\n        for (var i = 0; i < 2; ++i) {\r\n            if (this._textures[i]) {\r\n                gl_canvas_1.gl.deleteTexture(this._textures[i]);\r\n                this._textures[i] = null;\r\n            }\r\n        }\r\n    };\r\n    Automaton2D.prototype.initializeTextures = function (width, height) {\r\n        function upperPowerOfTwo(n) {\r\n            return Math.pow(2, Math.ceil(Math.log(n) * Math.LOG2E));\r\n        }\r\n        width = upperPowerOfTwo(width);\r\n        height = upperPowerOfTwo(height);\r\n        this._gridSize = [width, height];\r\n        var physicalWidth = width / 4;\r\n        var physicalHeight = height / 4;\r\n        this._FBO.width = physicalWidth;\r\n        this._FBO.height = physicalHeight;\r\n        this._textureSize = [physicalWidth, physicalHeight];\r\n        var data = new Uint8Array(4 * physicalWidth * physicalHeight);\r\n        for (var i = data.length - 1; i >= 0; --i) {\r\n            data[i] = Math.floor(256 * Math.random());\r\n        }\r\n        for (var i = 0; i < 2; ++i) {\r\n            if (this._textures[i] === null) {\r\n                this._textures[i] = gl_canvas_1.gl.createTexture();\r\n            }\r\n            gl_canvas_1.gl.bindTexture(gl_canvas_1.gl.TEXTURE_2D, this._textures[i]);\r\n            gl_canvas_1.gl.texImage2D(gl_canvas_1.gl.TEXTURE_2D, 0, gl_canvas_1.gl.RGBA, physicalWidth, physicalHeight, 0, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.UNSIGNED_BYTE, data);\r\n            gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MAG_FILTER, gl_canvas_1.gl.NEAREST);\r\n            gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MIN_FILTER, gl_canvas_1.gl.NEAREST);\r\n        }\r\n        this._currentIndex = 0;\r\n        this._iteration = 0;\r\n        this._needToRedraw = true;\r\n        Page.Canvas.setIndicatorText(\"grid-size\", width + \"x\" + height);\r\n    };\r\n    return Automaton2D;\r\n}(gl_resource_1.default));\r\nexports.default = Automaton2D;\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.deleteShader = exports.registerShader = exports.getShader = exports.buildShader = void 0;\r\nvar gl_canvas_1 = require(\"./gl-canvas\");\r\nvar shader_1 = __importDefault(require(\"./shader\"));\r\nvar ShaderSources = __importStar(require(\"./shader-sources\"));\r\nvar cachedShaders = {};\r\nfunction getShader(name) {\r\n    return cachedShaders[name].shader;\r\n}\r\nexports.getShader = getShader;\r\nfunction buildShader(infos, callback) {\r\n    var sourcesPending = 2;\r\n    var sourcesFailed = 0;\r\n    function loadedSource(success) {\r\n        function processSource(source) {\r\n            return source.replace(/#INJECT\\((.*)\\)/mg, function (match, name) {\r\n                if (infos.injected[name]) {\r\n                    return infos.injected[name];\r\n                }\r\n                return match;\r\n            });\r\n        }\r\n        sourcesPending--;\r\n        if (!success) {\r\n            sourcesFailed++;\r\n        }\r\n        if (sourcesPending === 0) {\r\n            var shader = null;\r\n            if (sourcesFailed === 0) {\r\n                var vert = ShaderSources.getSource(infos.vertexFilename);\r\n                var frag = ShaderSources.getSource(infos.fragmentFilename);\r\n                var processedVert = processSource(vert);\r\n                var processedFrag = processSource(frag);\r\n                shader = new shader_1.default(gl_canvas_1.gl, processedVert, processedFrag);\r\n            }\r\n            callback(shader);\r\n        }\r\n    }\r\n    ShaderSources.loadSource(infos.vertexFilename, loadedSource);\r\n    ShaderSources.loadSource(infos.fragmentFilename, loadedSource);\r\n}\r\nexports.buildShader = buildShader;\r\nfunction registerShader(name, infos, callback) {\r\n    function callAndClearCallbacks(cached) {\r\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\r\n            var cachedCallback = _a[_i];\r\n            cachedCallback(!cached.failed, cached.shader);\r\n        }\r\n        cached.callbacks = [];\r\n    }\r\n    if (typeof cachedShaders[name] === \"undefined\") {\r\n        cachedShaders[name] = {\r\n            callbacks: [callback],\r\n            failed: false,\r\n            infos: infos,\r\n            pending: true,\r\n            shader: null,\r\n        };\r\n        var cached_1 = cachedShaders[name];\r\n        buildShader(infos, function (builtShader) {\r\n            cached_1.pending = false;\r\n            cached_1.failed = builtShader === null;\r\n            cached_1.shader = builtShader;\r\n            callAndClearCallbacks(cached_1);\r\n        });\r\n    }\r\n    else {\r\n        var cached = cachedShaders[name];\r\n        if (cached.pending === true) {\r\n            cached.callbacks.push(callback);\r\n        }\r\n        else {\r\n            callAndClearCallbacks(cached);\r\n        }\r\n    }\r\n}\r\nexports.registerShader = registerShader;\r\nfunction deleteShader(name) {\r\n    if (cachedShaders[name]) {\r\n        if (cachedShaders[name].shader) {\r\n            cachedShaders[name].shader.freeGLResources();\r\n        }\r\n        delete cachedShaders[name];\r\n    }\r\n}\r\nexports.deleteShader = deleteShader;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\r\nfunction notImplemented(gl, location, value) {\r\n    alert(\"NOT IMPLEMENTED YET\");\r\n}\r\nfunction bindUniformFloat(gl, location, value) {\r\n    if (Array.isArray(value)) {\r\n        gl.uniform1fv(location, value);\r\n    }\r\n    else {\r\n        gl.uniform1f(location, value);\r\n    }\r\n}\r\nfunction bindUniformFloat2v(gl, location, value) {\r\n    gl.uniform2fv(location, value);\r\n}\r\nfunction bindUniformFloat3v(gl, location, value) {\r\n    gl.uniform3fv(location, value);\r\n}\r\nfunction bindUniformFloat4v(gl, location, value) {\r\n    gl.uniform4fv(location, value);\r\n}\r\nfunction bindUniformInt(gl, location, value) {\r\n    if (Array.isArray(value)) {\r\n        gl.uniform1iv(location, value);\r\n    }\r\n    else {\r\n        gl.uniform1iv(location, value);\r\n    }\r\n}\r\nfunction bindUniformInt2v(gl, location, value) {\r\n    gl.uniform2iv(location, value);\r\n}\r\nfunction bindUniformInt3v(gl, location, value) {\r\n    gl.uniform3iv(location, value);\r\n}\r\nfunction bindUniformInt4v(gl, location, value) {\r\n    gl.uniform4iv(location, value);\r\n}\r\nfunction bindUniformBool(gl, location, value) {\r\n    gl.uniform1i(location, +value);\r\n}\r\nfunction bindUniformBool2v(gl, location, value) {\r\n    gl.uniform2iv(location, value);\r\n}\r\nfunction bindUniformBool3v(gl, location, value) {\r\n    gl.uniform3iv(location, value);\r\n}\r\nfunction bindUniformBool4v(gl, location, value) {\r\n    gl.uniform4iv(location, value);\r\n}\r\nfunction bindUniformFloatMat2(gl, location, value) {\r\n    gl.uniformMatrix2fv(location, false, value);\r\n}\r\nfunction bindUniformFloatMat3(gl, location, value) {\r\n    gl.uniformMatrix3fv(location, false, value);\r\n}\r\nfunction bindUniformFloatMat4(gl, location, value) {\r\n    gl.uniformMatrix4fv(location, false, value);\r\n}\r\nfunction bindSampler2D(gl, location, unitNb, value) {\r\n    gl.uniform1i(location, unitNb);\r\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\r\n    gl.bindTexture(gl.TEXTURE_2D, value);\r\n}\r\nfunction bindSamplerCube(gl, location, unitNb, value) {\r\n    gl.uniform1i(location, unitNb);\r\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\r\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, value);\r\n}\r\nvar types = {\r\n    0x8B50: { str: \"FLOAT_VEC2\", binder: bindUniformFloat2v },\r\n    0x8B51: { str: \"FLOAT_VEC3\", binder: bindUniformFloat3v },\r\n    0x8B52: { str: \"FLOAT_VEC4\", binder: bindUniformFloat4v },\r\n    0x8B53: { str: \"INT_VEC2\", binder: bindUniformInt2v },\r\n    0x8B54: { str: \"INT_VEC3\", binder: bindUniformInt3v },\r\n    0x8B55: { str: \"INT_VEC4\", binder: bindUniformInt4v },\r\n    0x8B56: { str: \"BOOL\", binder: bindUniformBool },\r\n    0x8B57: { str: \"BOOL_VEC2\", binder: bindUniformBool2v },\r\n    0x8B58: { str: \"BOOL_VEC3\", binder: bindUniformBool3v },\r\n    0x8B59: { str: \"BOOL_VEC4\", binder: bindUniformBool4v },\r\n    0x8B5A: { str: \"FLOAT_MAT2\", binder: bindUniformFloatMat2 },\r\n    0x8B5B: { str: \"FLOAT_MAT3\", binder: bindUniformFloatMat3 },\r\n    0x8B5C: { str: \"FLOAT_MAT4\", binder: bindUniformFloatMat4 },\r\n    0x8B5E: { str: \"SAMPLER_2D\", binder: bindSampler2D },\r\n    0x8B60: { str: \"SAMPLER_CUBE\", binder: bindSamplerCube },\r\n    0x1400: { str: \"BYTE\", binder: notImplemented },\r\n    0x1401: { str: \"UNSIGNED_BYTE\", binder: notImplemented },\r\n    0x1402: { str: \"SHORT\", binder: notImplemented },\r\n    0x1403: { str: \"UNSIGNED_SHORT\", binder: notImplemented },\r\n    0x1404: { str: \"INT\", binder: bindUniformInt },\r\n    0x1405: { str: \"UNSIGNED_INT\", binder: notImplemented },\r\n    0x1406: { str: \"FLOAT\", binder: bindUniformFloat },\r\n};\r\nvar ShaderProgram = (function (_super) {\r\n    __extends(ShaderProgram, _super);\r\n    function ShaderProgram(gl, vertexSource, fragmentSource) {\r\n        var _this = this;\r\n        function createShader(type, source) {\r\n            var shader = gl.createShader(type);\r\n            gl.shaderSource(shader, source);\r\n            gl.compileShader(shader);\r\n            var compileSuccess = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n            if (!compileSuccess) {\r\n                console.error(gl.getShaderInfoLog(shader));\r\n                gl.deleteShader(shader);\r\n                return null;\r\n            }\r\n            return shader;\r\n        }\r\n        _this = _super.call(this, gl) || this;\r\n        _this.id = null;\r\n        _this.uCount = 0;\r\n        _this.aCount = 0;\r\n        var vertexShader = createShader(gl.VERTEX_SHADER, vertexSource);\r\n        var fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentSource);\r\n        var id = gl.createProgram();\r\n        gl.attachShader(id, vertexShader);\r\n        gl.attachShader(id, fragmentShader);\r\n        gl.linkProgram(id);\r\n        var linkSuccess = gl.getProgramParameter(id, gl.LINK_STATUS);\r\n        if (!linkSuccess) {\r\n            console.error(gl.getProgramInfoLog(id));\r\n            gl.deleteProgram(id);\r\n        }\r\n        else {\r\n            _this.id = id;\r\n            _this.introspection();\r\n        }\r\n        return _this;\r\n    }\r\n    ShaderProgram.prototype.freeGLResources = function () {\r\n        _super.prototype.gl.call(this).deleteProgram(this.id);\r\n        this.id = null;\r\n    };\r\n    ShaderProgram.prototype.use = function () {\r\n        _super.prototype.gl.call(this).useProgram(this.id);\r\n    };\r\n    ShaderProgram.prototype.bindUniforms = function () {\r\n        var _this = this;\r\n        var gl = _super.prototype.gl.call(this);\r\n        var currTextureUnitNb = 0;\r\n        Object.keys(this.u).forEach(function (uName) {\r\n            var uniform = _this.u[uName];\r\n            if (uniform.value !== null) {\r\n                if (uniform.type === 0x8B5E || uniform.type === 0x8B60) {\r\n                    var unitNb = currTextureUnitNb;\r\n                    types[uniform.type].binder(gl, uniform.loc, unitNb, uniform.value);\r\n                    currTextureUnitNb++;\r\n                }\r\n                else {\r\n                    types[uniform.type].binder(gl, uniform.loc, uniform.value);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    ShaderProgram.prototype.bindAttributes = function () {\r\n        var _this = this;\r\n        Object.keys(this.a).forEach(function (aName) {\r\n            var attribute = _this.a[aName];\r\n            if (attribute.VBO !== null) {\r\n                attribute.VBO.bind(attribute.loc);\r\n            }\r\n        });\r\n    };\r\n    ShaderProgram.prototype.bindUniformsAndAttributes = function () {\r\n        this.bindUniforms();\r\n        this.bindAttributes();\r\n    };\r\n    ShaderProgram.prototype.introspection = function () {\r\n        var gl = _super.prototype.gl.call(this);\r\n        this.uCount = gl.getProgramParameter(this.id, gl.ACTIVE_UNIFORMS);\r\n        this.u = [];\r\n        for (var i = 0; i < this.uCount; ++i) {\r\n            var uniform = gl.getActiveUniform(this.id, i);\r\n            var name_1 = uniform.name;\r\n            this.u[name_1] = {\r\n                loc: gl.getUniformLocation(this.id, name_1),\r\n                size: uniform.size,\r\n                type: uniform.type,\r\n                value: null,\r\n            };\r\n        }\r\n        this.aCount = gl.getProgramParameter(this.id, gl.ACTIVE_ATTRIBUTES);\r\n        this.a = [];\r\n        for (var i = 0; i < this.aCount; ++i) {\r\n            var attribute = gl.getActiveAttrib(this.id, i);\r\n            var name_2 = attribute.name;\r\n            this.a[name_2] = {\r\n                VBO: null,\r\n                loc: gl.getAttribLocation(this.id, name_2),\r\n                size: attribute.size,\r\n                type: attribute.type,\r\n            };\r\n        }\r\n    };\r\n    return ShaderProgram;\r\n}(gl_resource_1.default));\r\nexports.default = ShaderProgram;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.loadSource = exports.getSource = void 0;\r\nvar cachedSources = {};\r\nfunction loadSource(filename, callback) {\r\n    function callAndClearCallbacks(cached) {\r\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\r\n            var cachedCallback = _a[_i];\r\n            cachedCallback(!cached.failed);\r\n        }\r\n        cached.callbacks = [];\r\n    }\r\n    if (typeof cachedSources[filename] === \"undefined\") {\r\n        cachedSources[filename] = {\r\n            callbacks: [callback],\r\n            failed: false,\r\n            pending: true,\r\n            text: null,\r\n        };\r\n        var cached_1 = cachedSources[filename];\r\n        var xhr_1 = new XMLHttpRequest();\r\n        xhr_1.open(\"GET\", \"./shaders/\" + filename, true);\r\n        xhr_1.onload = function () {\r\n            if (xhr_1.readyState === 4) {\r\n                cached_1.pending = false;\r\n                if (xhr_1.status === 200) {\r\n                    cached_1.text = xhr_1.responseText;\r\n                    cached_1.failed = false;\r\n                }\r\n                else {\r\n                    console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\r\n                    cached_1.failed = true;\r\n                }\r\n                callAndClearCallbacks(cached_1);\r\n            }\r\n        };\r\n        xhr_1.onerror = function () {\r\n            console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\r\n            cached_1.pending = false;\r\n            cached_1.failed = true;\r\n            callAndClearCallbacks(cached_1);\r\n        };\r\n        xhr_1.send(null);\r\n    }\r\n    else {\r\n        var cached = cachedSources[filename];\r\n        if (cached.pending === true) {\r\n            cached.callbacks.push(callback);\r\n        }\r\n        else {\r\n            cached.callbacks = [callback];\r\n            callAndClearCallbacks(cached);\r\n        }\r\n    }\r\n}\r\nexports.loadSource = loadSource;\r\nfunction getSource(filename) {\r\n    return cachedSources[filename].text;\r\n}\r\nexports.getSource = getSource;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\r\nvar VBO = (function (_super) {\r\n    __extends(VBO, _super);\r\n    function VBO(gl, array, size, type) {\r\n        var _this = _super.call(this, gl) || this;\r\n        _this.id = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, _this.id);\r\n        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        _this.size = size;\r\n        _this.type = type;\r\n        _this.normalize = false;\r\n        _this.stride = 0;\r\n        _this.offset = 0;\r\n        return _this;\r\n    }\r\n    VBO.createQuad = function (gl, minX, minY, maxX, maxY) {\r\n        var vert = [\r\n            minX, minY,\r\n            maxX, minY,\r\n            minX, maxY,\r\n            maxX, maxY,\r\n        ];\r\n        return new VBO(gl, new Float32Array(vert), 2, gl.FLOAT);\r\n    };\r\n    VBO.prototype.freeGLResources = function () {\r\n        this.gl().deleteBuffer(this.id);\r\n        this.id = null;\r\n    };\r\n    VBO.prototype.bind = function (location) {\r\n        var gl = _super.prototype.gl.call(this);\r\n        gl.enableVertexAttribArray(location);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.id);\r\n        gl.vertexAttribPointer(location, this.size, this.type, this.normalize, this.stride, this.offset);\r\n    };\r\n    return VBO;\r\n}(gl_resource_1.default));\r\nexports.default = VBO;\r\n"],"sourceRoot":""}
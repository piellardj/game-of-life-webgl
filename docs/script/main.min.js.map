{"version":3,"file":"main.min.js","mappings":"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","sources":["webpack://game-of-life-webgl/./src/ts/automaton-2D.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/fbo.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/gl-canvas.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/gl-resource.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/shader-manager.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/shader-sources.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/shader.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/vbo.ts","webpack://game-of-life-webgl/./src/ts/gl-utils/viewport.ts","webpack://game-of-life-webgl/./src/ts/main.ts","webpack://game-of-life-webgl/./src/ts/parameters.ts","webpack://game-of-life-webgl/webpack/bootstrap","webpack://game-of-life-webgl/webpack/startup"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\nvar ShaderManager = __importStar(require(\"./gl-utils/shader-manager\"));\nvar vbo_1 = __importDefault(require(\"./gl-utils/vbo\"));\nvar parameters_1 = __importDefault(require(\"./parameters\"));\nrequire(\"./page-interface-generated\");\nvar Automaton2D = (function (_super) {\n    __extends(Automaton2D, _super);\n    function Automaton2D() {\n        var _this = _super.call(this, gl_canvas_1.gl) || this;\n        _this._FBO = new fbo_1.default(gl_canvas_1.gl, 512, 512);\n        _this._vbo = vbo_1.default.createQuad(gl_canvas_1.gl, -1, -1, 1, 1);\n        var initializeTexturesForCanvas = function () {\n            var canvasSize = Page.Canvas.getSize();\n            _this.initializeTextures(canvasSize[0], canvasSize[1]);\n            _this.recomputeVisibleSubTexture();\n        };\n        _this._needToRecomputeShader = true;\n        _this._mustClear = true;\n        _this._textures = [null, null];\n        _this._visibleSubTexture = [0, 0, 1, 1];\n        initializeTexturesForCanvas();\n        Page.Canvas.Observers.mouseDrag.push(function (dX, dY) {\n            _this._visibleSubTexture[0] -= dX * _this._visibleSubTexture[2];\n            _this._visibleSubTexture[1] -= dY * _this._visibleSubTexture[3];\n            _this.recomputeVisibleSubTexture();\n            _this._needToRedraw = true;\n            _this._mustClear = true;\n        });\n        Page.Canvas.Observers.canvasResize.push(initializeTexturesForCanvas);\n        parameters_1.default.resetObservers.push(initializeTexturesForCanvas);\n        parameters_1.default.rulesObservers.push(function () { return _this._needToRecomputeShader = true; });\n        var previousScale = parameters_1.default.scale;\n        parameters_1.default.scaleObservers.push(function (newScale, zoomCenter) {\n            _this._needToRedraw = true;\n            _this._mustClear = true;\n            _this._visibleSubTexture[0] += zoomCenter[0] * (1 - previousScale / newScale) * _this._visibleSubTexture[2];\n            _this._visibleSubTexture[1] += zoomCenter[1] * (1 - previousScale / newScale) * _this._visibleSubTexture[3];\n            previousScale = newScale;\n            _this.recomputeVisibleSubTexture();\n        });\n        ShaderManager.buildShader({\n            fragmentFilename: \"display-2D.frag\",\n            vertexFilename: \"display-2D.vert\",\n            injected: {},\n        }, function (shader) {\n            if (shader !== null) {\n                _this._displayShader = shader;\n                _this._displayShader.a[\"aCorner\"].VBO = _this._vbo;\n                _this._displayShader.u[\"uSubTexture\"].value = _this._visibleSubTexture;\n            }\n        });\n        return _this;\n    }\n    Automaton2D.prototype.freeGLResources = function () {\n        if (this._FBO) {\n            this._FBO.freeGLResources();\n        }\n        if (this._vbo) {\n            this._vbo.freeGLResources();\n            this._vbo = null;\n        }\n        if (this._displayShader) {\n            this._displayShader.freeGLResources();\n            this._displayShader = null;\n        }\n        if (this._updateShader) {\n            this._updateShader.freeGLResources();\n            this._updateShader = null;\n        }\n        this.freeTextures();\n    };\n    Automaton2D.prototype.update = function () {\n        if (this._needToRecomputeShader) {\n            this.recomputeUpdateShader();\n        }\n        var shader = this._updateShader;\n        if (shader) {\n            var current = this._textures[this._currentIndex];\n            var next = this._textures[(this._currentIndex + 1) % 2];\n            this._FBO.bind([next]);\n            shader.u[\"uPrevious\"].value = current;\n            shader.u[\"uPhysicalCellSize\"].value = [1 / this._textureSize[0], 1 / this._textureSize[1]];\n            shader.use();\n            shader.bindUniformsAndAttributes();\n            gl_canvas_1.gl.disable(gl_canvas_1.gl.BLEND);\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\n            this._currentIndex = (this._currentIndex + 1) % 2;\n            this._iteration++;\n        }\n    };\n    Automaton2D.prototype.draw = function () {\n        var shader = this._displayShader;\n        if (shader) {\n            shader.u[\"uClearFactor\"].value = (this._mustClear) ? 1 : 1 - parameters_1.default.persistence;\n            shader.u[\"uTexture\"].value = this._textures[this._currentIndex];\n            shader.u[\"uGridSize\"].value = this._gridSize;\n            shader.use();\n            shader.bindUniformsAndAttributes();\n            gl_canvas_1.gl.enable(gl_canvas_1.gl.BLEND);\n            gl_canvas_1.gl.drawArrays(gl_canvas_1.gl.TRIANGLE_STRIP, 0, 4);\n            this._needToRedraw = false;\n            this._mustClear = false;\n        }\n    };\n    Object.defineProperty(Automaton2D.prototype, \"iteration\", {\n        get: function () {\n            return this._iteration;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Automaton2D.prototype, \"needToRedraw\", {\n        get: function () {\n            return this._needToRedraw;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Automaton2D.prototype, \"needToUpdate\", {\n        get: function () {\n            return this._needToRecomputeShader;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Automaton2D.prototype.recomputeUpdateShader = function () {\n        var _this = this;\n        ShaderManager.buildShader({\n            fragmentFilename: \"update-2D.frag\",\n            vertexFilename: \"update-2D.vert\",\n            injected: { rules: this.generateShaderRules() },\n        }, function (shader) {\n            if (shader !== null) {\n                if (_this._updateShader) {\n                    _this._updateShader.freeGLResources();\n                }\n                _this._updateShader = shader;\n                _this._updateShader.a[\"aCorner\"].VBO = _this._vbo;\n            }\n        });\n        this._needToRecomputeShader = false;\n    };\n    Automaton2D.prototype.generateShaderRules = function () {\n        function generateRuleBlock(starting, ending, rule) {\n            if (rule !== \"alive\") {\n                var operation = (rule === \"death\") ? \" -= \" : \" += \";\n                var rangeCheck = void 0;\n                if (starting === 0) {\n                    rangeCheck = \"step(N, \" + (ending + .5) + \")\";\n                    if (ending === 8) {\n                        rangeCheck = \"1.0\";\n                    }\n                }\n                else if (ending === 8) {\n                    rangeCheck = \"step(\" + (starting - .5) + \", N)\";\n                }\n                else {\n                    rangeCheck = \"step(\" + (starting - .5) + \", N) * step(N, \" + (ending + .5) + \")\";\n                }\n                return \"currentState\" + operation + rangeCheck + \";\\n\";\n            }\n            return \"\";\n        }\n        var result = \"\";\n        var rules = parameters_1.default.rules;\n        var currentRule = rules[0];\n        var from = 0;\n        for (var i = 1; i < 9; ++i) {\n            if (rules[i] !== currentRule) {\n                result += generateRuleBlock(from, i - 1, currentRule);\n                currentRule = rules[i];\n                from = i;\n            }\n        }\n        result += generateRuleBlock(from, 8, currentRule);\n        return result;\n    };\n    Automaton2D.prototype.recomputeVisibleSubTexture = function () {\n        var canvasSize = Page.Canvas.getSize();\n        this._visibleSubTexture[2] = canvasSize[0] / this._gridSize[0] / parameters_1.default.scale;\n        this._visibleSubTexture[3] = canvasSize[1] / this._gridSize[1] / parameters_1.default.scale;\n        for (var i = 0; i < 2; ++i) {\n            this._visibleSubTexture[i] -= Math.min(0, this._visibleSubTexture[i]);\n            this._visibleSubTexture[i] -= Math.max(0, this._visibleSubTexture[i] + this._visibleSubTexture[i + 2] - 1);\n        }\n    };\n    Automaton2D.prototype.freeTextures = function () {\n        for (var i = 0; i < 2; ++i) {\n            if (this._textures[i]) {\n                gl_canvas_1.gl.deleteTexture(this._textures[i]);\n                this._textures[i] = null;\n            }\n        }\n    };\n    Automaton2D.prototype.initializeTextures = function (width, height) {\n        function upperPowerOfTwo(n) {\n            return Math.pow(2, Math.ceil(Math.log(n) * Math.LOG2E));\n        }\n        width = upperPowerOfTwo(width);\n        height = upperPowerOfTwo(height);\n        this._gridSize = [width, height];\n        var physicalWidth = width / 4;\n        var physicalHeight = height / 4;\n        this._FBO.width = physicalWidth;\n        this._FBO.height = physicalHeight;\n        this._textureSize = [physicalWidth, physicalHeight];\n        var data = new Uint8Array(4 * physicalWidth * physicalHeight);\n        for (var i = data.length - 1; i >= 0; --i) {\n            data[i] = Math.floor(256 * Math.random());\n        }\n        for (var i = 0; i < 2; ++i) {\n            if (this._textures[i] === null) {\n                this._textures[i] = gl_canvas_1.gl.createTexture();\n            }\n            gl_canvas_1.gl.bindTexture(gl_canvas_1.gl.TEXTURE_2D, this._textures[i]);\n            gl_canvas_1.gl.texImage2D(gl_canvas_1.gl.TEXTURE_2D, 0, gl_canvas_1.gl.RGBA, physicalWidth, physicalHeight, 0, gl_canvas_1.gl.RGBA, gl_canvas_1.gl.UNSIGNED_BYTE, data);\n            gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MAG_FILTER, gl_canvas_1.gl.NEAREST);\n            gl_canvas_1.gl.texParameteri(gl_canvas_1.gl.TEXTURE_2D, gl_canvas_1.gl.TEXTURE_MIN_FILTER, gl_canvas_1.gl.NEAREST);\n        }\n        this._currentIndex = 0;\n        this._iteration = 0;\n        this._needToRedraw = true;\n        Page.Canvas.setIndicatorText(\"grid-size\", width + \"x\" + height);\n    };\n    return Automaton2D;\n}(gl_resource_1.default));\nexports.default = Automaton2D;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nvar FBO = (function (_super) {\n    __extends(FBO, _super);\n    function FBO(gl, width, height) {\n        var _this = _super.call(this, gl) || this;\n        _this.id = gl.createFramebuffer();\n        _this.width = width;\n        _this.height = height;\n        return _this;\n    }\n    FBO.bindDefault = function (gl, viewport) {\n        if (viewport === void 0) { viewport = null; }\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        if (viewport === null) {\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n        }\n        else {\n            gl.viewport(viewport.left, viewport.lower, viewport.width, viewport.height);\n        }\n    };\n    FBO.prototype.bind = function (colorBuffers, depthBuffer) {\n        if (depthBuffer === void 0) { depthBuffer = null; }\n        var gl = _super.prototype.gl.call(this);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.id);\n        gl.viewport(0, 0, this.width, this.height);\n        for (var i = 0; i < colorBuffers.length; ++i) {\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl[\"COLOR_ATTACHMENT\" + i], gl.TEXTURE_2D, colorBuffers[i], 0);\n        }\n        if (depthBuffer) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, depthBuffer);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, depthBuffer);\n        }\n    };\n    FBO.prototype.freeGLResources = function () {\n        _super.prototype.gl.call(this).deleteFramebuffer(this.id);\n        this.id = null;\n    };\n    return FBO;\n}(gl_resource_1.default));\nexports.default = FBO;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.gl = exports.initGL = exports.adjustSize = void 0;\nrequire(\"../page-interface-generated\");\nvar gl = null;\nexports.gl = gl;\nfunction initGL(flags) {\n    function setError(message) {\n        Page.Demopage.setErrorMessage(\"webgl-support\", message);\n    }\n    var canvas = Page.Canvas.getCanvas();\n    exports.gl = gl = canvas.getContext(\"webgl\", flags);\n    if (gl == null) {\n        exports.gl = gl = canvas.getContext(\"experimental-webgl\", flags);\n        if (gl == null) {\n            setError(\"Your browser or device does not seem to support WebGL.\");\n            return false;\n        }\n        setError(\"Your browser or device only supports experimental WebGL.\\n\" +\n            \"The simulation may not run as expected.\");\n    }\n    gl.disable(gl.CULL_FACE);\n    gl.disable(gl.DEPTH_TEST);\n    gl.disable(gl.BLEND);\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\n    return true;\n}\nexports.initGL = initGL;\nfunction adjustSize(hidpi) {\n    if (hidpi === void 0) { hidpi = false; }\n    var cssPixel = (hidpi) ? window.devicePixelRatio : 1;\n    var canvas = gl.canvas;\n    var width = Math.floor(canvas.clientWidth * cssPixel);\n    var height = Math.floor(canvas.clientHeight * cssPixel);\n    if (canvas.width !== width || canvas.height !== height) {\n        canvas.width = width;\n        canvas.height = height;\n    }\n}\nexports.adjustSize = adjustSize;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GLResource = (function () {\n    function GLResource(gl) {\n        this._gl = gl;\n    }\n    GLResource.prototype.gl = function () {\n        return this._gl;\n    };\n    return GLResource;\n}());\nexports.default = GLResource;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.deleteShader = exports.registerShader = exports.getShader = exports.buildShader = void 0;\nvar gl_canvas_1 = require(\"./gl-canvas\");\nvar shader_1 = __importDefault(require(\"./shader\"));\nvar ShaderSources = __importStar(require(\"./shader-sources\"));\nvar cachedShaders = {};\nfunction getShader(name) {\n    return cachedShaders[name].shader;\n}\nexports.getShader = getShader;\nfunction buildShader(infos, callback) {\n    var sourcesPending = 2;\n    var sourcesFailed = 0;\n    function loadedSource(success) {\n        function processSource(source) {\n            return source.replace(/#INJECT\\((.*)\\)/mg, function (match, name) {\n                if (infos.injected[name]) {\n                    return infos.injected[name];\n                }\n                return match;\n            });\n        }\n        sourcesPending--;\n        if (!success) {\n            sourcesFailed++;\n        }\n        if (sourcesPending === 0) {\n            var shader = null;\n            if (sourcesFailed === 0) {\n                var vert = ShaderSources.getSource(infos.vertexFilename);\n                var frag = ShaderSources.getSource(infos.fragmentFilename);\n                var processedVert = processSource(vert);\n                var processedFrag = processSource(frag);\n                shader = new shader_1.default(gl_canvas_1.gl, processedVert, processedFrag);\n            }\n            callback(shader);\n        }\n    }\n    ShaderSources.loadSource(infos.vertexFilename, loadedSource);\n    ShaderSources.loadSource(infos.fragmentFilename, loadedSource);\n}\nexports.buildShader = buildShader;\nfunction registerShader(name, infos, callback) {\n    function callAndClearCallbacks(cached) {\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\n            var cachedCallback = _a[_i];\n            cachedCallback(!cached.failed, cached.shader);\n        }\n        cached.callbacks = [];\n    }\n    if (typeof cachedShaders[name] === \"undefined\") {\n        cachedShaders[name] = {\n            callbacks: [callback],\n            failed: false,\n            infos: infos,\n            pending: true,\n            shader: null,\n        };\n        var cached_1 = cachedShaders[name];\n        buildShader(infos, function (builtShader) {\n            cached_1.pending = false;\n            cached_1.failed = builtShader === null;\n            cached_1.shader = builtShader;\n            callAndClearCallbacks(cached_1);\n        });\n    }\n    else {\n        var cached = cachedShaders[name];\n        if (cached.pending === true) {\n            cached.callbacks.push(callback);\n        }\n        else {\n            callAndClearCallbacks(cached);\n        }\n    }\n}\nexports.registerShader = registerShader;\nfunction deleteShader(name) {\n    if (cachedShaders[name]) {\n        if (cachedShaders[name].shader) {\n            cachedShaders[name].shader.freeGLResources();\n        }\n        delete cachedShaders[name];\n    }\n}\nexports.deleteShader = deleteShader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.loadSource = exports.getSource = void 0;\nvar cachedSources = {};\nfunction loadSource(filename, callback) {\n    function callAndClearCallbacks(cached) {\n        for (var _i = 0, _a = cached.callbacks; _i < _a.length; _i++) {\n            var cachedCallback = _a[_i];\n            cachedCallback(!cached.failed);\n        }\n        cached.callbacks = [];\n    }\n    if (typeof cachedSources[filename] === \"undefined\") {\n        cachedSources[filename] = {\n            callbacks: [callback],\n            failed: false,\n            pending: true,\n            text: null,\n        };\n        var cached_1 = cachedSources[filename];\n        var xhr_1 = new XMLHttpRequest();\n        xhr_1.open(\"GET\", \"./shaders/\" + filename, true);\n        xhr_1.onload = function () {\n            if (xhr_1.readyState === 4) {\n                cached_1.pending = false;\n                if (xhr_1.status === 200) {\n                    cached_1.text = xhr_1.responseText;\n                    cached_1.failed = false;\n                }\n                else {\n                    console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\n                    cached_1.failed = true;\n                }\n                callAndClearCallbacks(cached_1);\n            }\n        };\n        xhr_1.onerror = function () {\n            console.error(\"Cannot load '\" + filename + \"' shader source: \" + xhr_1.statusText);\n            cached_1.pending = false;\n            cached_1.failed = true;\n            callAndClearCallbacks(cached_1);\n        };\n        xhr_1.send(null);\n    }\n    else {\n        var cached = cachedSources[filename];\n        if (cached.pending === true) {\n            cached.callbacks.push(callback);\n        }\n        else {\n            cached.callbacks = [callback];\n            callAndClearCallbacks(cached);\n        }\n    }\n}\nexports.loadSource = loadSource;\nfunction getSource(filename) {\n    return cachedSources[filename].text;\n}\nexports.getSource = getSource;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nfunction notImplemented(gl, location, value) {\n    alert(\"NOT IMPLEMENTED YET\");\n}\nfunction bindUniformFloat(gl, location, value) {\n    if (Array.isArray(value)) {\n        gl.uniform1fv(location, value);\n    }\n    else {\n        gl.uniform1f(location, value);\n    }\n}\nfunction bindUniformFloat2v(gl, location, value) {\n    gl.uniform2fv(location, value);\n}\nfunction bindUniformFloat3v(gl, location, value) {\n    gl.uniform3fv(location, value);\n}\nfunction bindUniformFloat4v(gl, location, value) {\n    gl.uniform4fv(location, value);\n}\nfunction bindUniformInt(gl, location, value) {\n    if (Array.isArray(value)) {\n        gl.uniform1iv(location, value);\n    }\n    else {\n        gl.uniform1iv(location, value);\n    }\n}\nfunction bindUniformInt2v(gl, location, value) {\n    gl.uniform2iv(location, value);\n}\nfunction bindUniformInt3v(gl, location, value) {\n    gl.uniform3iv(location, value);\n}\nfunction bindUniformInt4v(gl, location, value) {\n    gl.uniform4iv(location, value);\n}\nfunction bindUniformBool(gl, location, value) {\n    gl.uniform1i(location, +value);\n}\nfunction bindUniformBool2v(gl, location, value) {\n    gl.uniform2iv(location, value);\n}\nfunction bindUniformBool3v(gl, location, value) {\n    gl.uniform3iv(location, value);\n}\nfunction bindUniformBool4v(gl, location, value) {\n    gl.uniform4iv(location, value);\n}\nfunction bindUniformFloatMat2(gl, location, value) {\n    gl.uniformMatrix2fv(location, false, value);\n}\nfunction bindUniformFloatMat3(gl, location, value) {\n    gl.uniformMatrix3fv(location, false, value);\n}\nfunction bindUniformFloatMat4(gl, location, value) {\n    gl.uniformMatrix4fv(location, false, value);\n}\nfunction bindSampler2D(gl, location, unitNb, value) {\n    gl.uniform1i(location, unitNb);\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\n    gl.bindTexture(gl.TEXTURE_2D, value);\n}\nfunction bindSamplerCube(gl, location, unitNb, value) {\n    gl.uniform1i(location, unitNb);\n    gl.activeTexture(gl[\"TEXTURE\" + unitNb]);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, value);\n}\nvar types = {\n    0x8B50: { str: \"FLOAT_VEC2\", binder: bindUniformFloat2v },\n    0x8B51: { str: \"FLOAT_VEC3\", binder: bindUniformFloat3v },\n    0x8B52: { str: \"FLOAT_VEC4\", binder: bindUniformFloat4v },\n    0x8B53: { str: \"INT_VEC2\", binder: bindUniformInt2v },\n    0x8B54: { str: \"INT_VEC3\", binder: bindUniformInt3v },\n    0x8B55: { str: \"INT_VEC4\", binder: bindUniformInt4v },\n    0x8B56: { str: \"BOOL\", binder: bindUniformBool },\n    0x8B57: { str: \"BOOL_VEC2\", binder: bindUniformBool2v },\n    0x8B58: { str: \"BOOL_VEC3\", binder: bindUniformBool3v },\n    0x8B59: { str: \"BOOL_VEC4\", binder: bindUniformBool4v },\n    0x8B5A: { str: \"FLOAT_MAT2\", binder: bindUniformFloatMat2 },\n    0x8B5B: { str: \"FLOAT_MAT3\", binder: bindUniformFloatMat3 },\n    0x8B5C: { str: \"FLOAT_MAT4\", binder: bindUniformFloatMat4 },\n    0x8B5E: { str: \"SAMPLER_2D\", binder: bindSampler2D },\n    0x8B60: { str: \"SAMPLER_CUBE\", binder: bindSamplerCube },\n    0x1400: { str: \"BYTE\", binder: notImplemented },\n    0x1401: { str: \"UNSIGNED_BYTE\", binder: notImplemented },\n    0x1402: { str: \"SHORT\", binder: notImplemented },\n    0x1403: { str: \"UNSIGNED_SHORT\", binder: notImplemented },\n    0x1404: { str: \"INT\", binder: bindUniformInt },\n    0x1405: { str: \"UNSIGNED_INT\", binder: notImplemented },\n    0x1406: { str: \"FLOAT\", binder: bindUniformFloat },\n};\nvar ShaderProgram = (function (_super) {\n    __extends(ShaderProgram, _super);\n    function ShaderProgram(gl, vertexSource, fragmentSource) {\n        var _this = this;\n        function createShader(type, source) {\n            var shader = gl.createShader(type);\n            gl.shaderSource(shader, source);\n            gl.compileShader(shader);\n            var compileSuccess = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n            if (!compileSuccess) {\n                console.error(gl.getShaderInfoLog(shader));\n                gl.deleteShader(shader);\n                return null;\n            }\n            return shader;\n        }\n        _this = _super.call(this, gl) || this;\n        _this.id = null;\n        _this.uCount = 0;\n        _this.aCount = 0;\n        var vertexShader = createShader(gl.VERTEX_SHADER, vertexSource);\n        var fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentSource);\n        var id = gl.createProgram();\n        gl.attachShader(id, vertexShader);\n        gl.attachShader(id, fragmentShader);\n        gl.linkProgram(id);\n        var linkSuccess = gl.getProgramParameter(id, gl.LINK_STATUS);\n        if (!linkSuccess) {\n            console.error(gl.getProgramInfoLog(id));\n            gl.deleteProgram(id);\n        }\n        else {\n            _this.id = id;\n            _this.introspection();\n        }\n        return _this;\n    }\n    ShaderProgram.prototype.freeGLResources = function () {\n        _super.prototype.gl.call(this).deleteProgram(this.id);\n        this.id = null;\n    };\n    ShaderProgram.prototype.use = function () {\n        _super.prototype.gl.call(this).useProgram(this.id);\n    };\n    ShaderProgram.prototype.bindUniforms = function () {\n        var _this = this;\n        var gl = _super.prototype.gl.call(this);\n        var currTextureUnitNb = 0;\n        Object.keys(this.u).forEach(function (uName) {\n            var uniform = _this.u[uName];\n            if (uniform.value !== null) {\n                if (uniform.type === 0x8B5E || uniform.type === 0x8B60) {\n                    var unitNb = currTextureUnitNb;\n                    types[uniform.type].binder(gl, uniform.loc, unitNb, uniform.value);\n                    currTextureUnitNb++;\n                }\n                else {\n                    types[uniform.type].binder(gl, uniform.loc, uniform.value);\n                }\n            }\n        });\n    };\n    ShaderProgram.prototype.bindAttributes = function () {\n        var _this = this;\n        Object.keys(this.a).forEach(function (aName) {\n            var attribute = _this.a[aName];\n            if (attribute.VBO !== null) {\n                attribute.VBO.bind(attribute.loc);\n            }\n        });\n    };\n    ShaderProgram.prototype.bindUniformsAndAttributes = function () {\n        this.bindUniforms();\n        this.bindAttributes();\n    };\n    ShaderProgram.prototype.introspection = function () {\n        var gl = _super.prototype.gl.call(this);\n        this.uCount = gl.getProgramParameter(this.id, gl.ACTIVE_UNIFORMS);\n        this.u = [];\n        for (var i = 0; i < this.uCount; ++i) {\n            var uniform = gl.getActiveUniform(this.id, i);\n            var name_1 = uniform.name;\n            this.u[name_1] = {\n                loc: gl.getUniformLocation(this.id, name_1),\n                size: uniform.size,\n                type: uniform.type,\n                value: null,\n            };\n        }\n        this.aCount = gl.getProgramParameter(this.id, gl.ACTIVE_ATTRIBUTES);\n        this.a = [];\n        for (var i = 0; i < this.aCount; ++i) {\n            var attribute = gl.getActiveAttrib(this.id, i);\n            var name_2 = attribute.name;\n            this.a[name_2] = {\n                VBO: null,\n                loc: gl.getAttribLocation(this.id, name_2),\n                size: attribute.size,\n                type: attribute.type,\n            };\n        }\n    };\n    return ShaderProgram;\n}(gl_resource_1.default));\nexports.default = ShaderProgram;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nvar VBO = (function (_super) {\n    __extends(VBO, _super);\n    function VBO(gl, array, size, type) {\n        var _this = _super.call(this, gl) || this;\n        _this.id = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, _this.id);\n        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n        _this.size = size;\n        _this.type = type;\n        _this.normalize = false;\n        _this.stride = 0;\n        _this.offset = 0;\n        return _this;\n    }\n    VBO.createQuad = function (gl, minX, minY, maxX, maxY) {\n        var vert = [\n            minX, minY,\n            maxX, minY,\n            minX, maxY,\n            maxX, maxY,\n        ];\n        return new VBO(gl, new Float32Array(vert), 2, gl.FLOAT);\n    };\n    VBO.prototype.freeGLResources = function () {\n        this.gl().deleteBuffer(this.id);\n        this.id = null;\n    };\n    VBO.prototype.bind = function (location) {\n        var gl = _super.prototype.gl.call(this);\n        gl.enableVertexAttribArray(location);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.id);\n        gl.vertexAttribPointer(location, this.size, this.type, this.normalize, this.stride, this.offset);\n    };\n    return VBO;\n}(gl_resource_1.default));\nexports.default = VBO;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Viewport = (function () {\n    function Viewport(left, lower, width, height) {\n        this.left = left;\n        this.lower = lower;\n        this.width = width;\n        this.height = height;\n    }\n    Viewport.setFullCanvas = function (gl) {\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    };\n    Viewport.prototype.set = function (gl) {\n        gl.viewport(this.lower, this.left, this.width, this.height);\n    };\n    return Viewport;\n}());\nexports.default = Viewport;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\nvar GlCanvas = __importStar(require(\"./gl-utils/gl-canvas\"));\nvar gl_canvas_1 = require(\"./gl-utils/gl-canvas\");\nvar viewport_1 = __importDefault(require(\"./gl-utils/viewport\"));\nvar automaton_2D_1 = __importDefault(require(\"./automaton-2D\"));\nvar parameters_1 = __importDefault(require(\"./parameters\"));\nrequire(\"./page-interface-generated\");\nfunction main() {\n    var glParams = {\n        alpha: false,\n        preserveDrawingBuffer: true,\n    };\n    if (!GlCanvas.initGL(glParams)) {\n        return;\n    }\n    gl_canvas_1.gl.blendFunc(gl_canvas_1.gl.ONE, gl_canvas_1.gl.ONE_MINUS_SRC_ALPHA);\n    Page.Canvas.showLoader(true);\n    var needToAdjustSize = true;\n    Page.Canvas.Observers.canvasResize.push(function () { return needToAdjustSize = true; });\n    parameters_1.default.autorun = true;\n    parameters_1.default.persistence = 0;\n    var automaton = new automaton_2D_1.default();\n    var lastIteration = automaton.iteration;\n    function updateIterationPerSecIndicator() {\n        Page.Canvas.setIndicatorText(\"iterations-per-sec\", \"\" + (automaton.iteration - lastIteration));\n        lastIteration = automaton.iteration;\n    }\n    window.setInterval(updateIterationPerSecIndicator, 1000);\n    function updateIterationIndicator() {\n        Page.Canvas.setIndicatorText(\"iteration\", \"\" + automaton.iteration);\n    }\n    window.setInterval(updateIterationIndicator, 50);\n    var forceUpdate = false;\n    parameters_1.default.nextStepObservers.push(function () { return forceUpdate = true; });\n    var firstDraw = true;\n    var lastUpdate = 0;\n    function mainLoop(time) {\n        var update = automaton.needToUpdate || forceUpdate ||\n            (parameters_1.default.autorun && (time - lastUpdate > parameters_1.default.updateWaitTime));\n        if (update) {\n            lastUpdate = time;\n            automaton.update();\n            forceUpdate = false;\n        }\n        if (update || automaton.needToRedraw) {\n            fbo_1.default.bindDefault(gl_canvas_1.gl);\n            if (needToAdjustSize) {\n                GlCanvas.adjustSize();\n                needToAdjustSize = false;\n            }\n            viewport_1.default.setFullCanvas(gl_canvas_1.gl);\n            automaton.draw();\n            if (firstDraw) {\n                firstDraw = false;\n                Page.Canvas.showLoader(false);\n            }\n        }\n        requestAnimationFrame(mainLoop);\n    }\n    requestAnimationFrame(mainLoop);\n}\nmain();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"./page-interface-generated\");\nvar Rule;\n(function (Rule) {\n    Rule[\"DEATH\"] = \"death\";\n    Rule[\"ALIVE\"] = \"alive\";\n    Rule[\"BIRTH\"] = \"birth\";\n})(Rule || (Rule = {}));\nvar DEFAULT_RULES = [\n    Rule.DEATH,\n    Rule.DEATH,\n    Rule.ALIVE,\n    Rule.BIRTH,\n    Rule.DEATH,\n    Rule.DEATH,\n    Rule.DEATH,\n    Rule.DEATH,\n    Rule.DEATH,\n];\nvar rules = DEFAULT_RULES.slice();\nfunction updateRuleControl(id) {\n    var controlId = \"neighbours-tabs-\".concat(id);\n    if (rules[id] === Rule.DEATH) {\n        Page.Tabs.setValues(controlId, [\"death\"]);\n    }\n    else if (rules[id] === Rule.ALIVE) {\n        Page.Tabs.setValues(controlId, [\"alive\"]);\n    }\n    else if (rules[id] === Rule.BIRTH) {\n        Page.Tabs.setValues(controlId, [\"alive\", \"birth\"]);\n    }\n    Page.Tabs.storeState(controlId);\n}\nvar rulesObservers = [];\nfunction callRulesObservers() {\n    for (var _i = 0, rulesObservers_1 = rulesObservers; _i < rulesObservers_1.length; _i++) {\n        var observer = rulesObservers_1[_i];\n        observer();\n    }\n}\nvar CUSTOM_RULE_FLAG = \"customrules\";\nfunction addCustomRulesUrlFlag() {\n    if (typeof URLSearchParams !== \"undefined\") {\n        var searchParamsObject = new URLSearchParams(window.location.search);\n        searchParamsObject.set(CUSTOM_RULE_FLAG, \"true\");\n        var searchParams = searchParamsObject.toString();\n        var newUrl = window.location.origin + window.location.pathname + (searchParams ? \"?\".concat(searchParams) : \"\");\n        window.history.replaceState(\"\", \"\", newUrl);\n    }\n    for (var i = 0; i < 9; i++) {\n        var controlId = \"neighbours-tabs-\".concat(i);\n        Page.Tabs.storeState(controlId);\n    }\n}\nfunction removeCustomRulesUrlFlag() {\n    if (typeof URLSearchParams !== \"undefined\") {\n        var searchParamsObject = new URLSearchParams(window.location.search);\n        searchParamsObject.delete(CUSTOM_RULE_FLAG);\n        var searchParams = searchParamsObject.toString();\n        var newUrl = window.location.origin + window.location.pathname + (searchParams ? \"?\".concat(searchParams) : \"\");\n        window.history.replaceState(\"\", \"\", newUrl);\n    }\n}\nfunction isCustomRulesUrlFlagPresent() {\n    if (typeof URLSearchParams !== \"undefined\") {\n        var searchParamsObject = new URLSearchParams(window.location.search);\n        return searchParamsObject.has(CUSTOM_RULE_FLAG);\n    }\n    return false;\n}\nwindow.addEventListener(\"load\", function () {\n    var customRules = isCustomRulesUrlFlagPresent();\n    var _loop_1 = function (i) {\n        var controlId = \"neighbours-tabs-\".concat(i);\n        Page.Tabs.addObserver(controlId, function (values) {\n            var previous = rules[i];\n            if (rules[i] !== Rule.DEATH && values.indexOf(Rule.DEATH) >= 0) {\n                rules[i] = Rule.DEATH;\n            }\n            else if (rules[i] !== Rule.ALIVE && values.indexOf(Rule.ALIVE) >= 0) {\n                rules[i] = Rule.ALIVE;\n            }\n            else if (rules[i] !== Rule.BIRTH && values.indexOf(Rule.BIRTH) >= 0) {\n                rules[i] = Rule.BIRTH;\n            }\n            updateRuleControl(i);\n            addCustomRulesUrlFlag();\n            if (previous !== rules[i]) {\n                callRulesObservers();\n            }\n        });\n        if (customRules) {\n            var values = Page.Tabs.getValues(controlId);\n            if (values.indexOf(Rule.BIRTH) >= 0) {\n                rules[i] = Rule.BIRTH;\n            }\n            else if (values.indexOf(Rule.ALIVE) >= 0) {\n                rules[i] = Rule.ALIVE;\n            }\n            else {\n                rules[i] = Rule.DEATH;\n            }\n        }\n        updateRuleControl(i);\n    };\n    for (var i = 0; i < 9; ++i) {\n        _loop_1(i);\n    }\n    callRulesObservers();\n});\nPage.Button.addObserver(\"reset-rules-button-id\", function () {\n    var somethingChanged = false;\n    for (var i = 0; i < 9; i++) {\n        somethingChanged = somethingChanged || (rules[i] !== DEFAULT_RULES[i]);\n        rules[i] = DEFAULT_RULES[i];\n        updateRuleControl(i);\n        Page.Tabs.clearStoredState(\"neighbours-tabs-\".concat(i));\n    }\n    removeCustomRulesUrlFlag();\n    if (somethingChanged) {\n        callRulesObservers();\n    }\n});\nvar autorun;\nvar AUTORUN_CONTROL_ID = \"autorun-checkbox-id\";\nPage.Checkbox.addObserver(AUTORUN_CONTROL_ID, function (checked) {\n    autorun = checked;\n});\nautorun = Page.Checkbox.isChecked(AUTORUN_CONTROL_ID);\nvar speed;\nvar updateWaitTime = [1000 / 1, 1000 / 2, 1000 / 5, 1000 / 11, 1000 / 31, 0];\nvar SPEED_CONTROL_ID = \"speed-range-id\";\nPage.Range.addObserver(SPEED_CONTROL_ID, function (newValue) {\n    speed = newValue;\n});\nspeed = Page.Range.getValue(SPEED_CONTROL_ID);\nvar NEXT_STEP_CONTROL_ID = \"next-button-id\";\nvar nextStepObservers = [];\nPage.Button.addObserver(NEXT_STEP_CONTROL_ID, function () {\n    for (var _i = 0, nextStepObservers_1 = nextStepObservers; _i < nextStepObservers_1.length; _i++) {\n        var observer = nextStepObservers_1[_i];\n        observer();\n    }\n});\nvar RESET_CONTROL_ID = \"reset-button-id\";\nvar resetObservers = [];\nPage.Button.addObserver(RESET_CONTROL_ID, function () {\n    for (var _i = 0, resetObservers_1 = resetObservers; _i < resetObservers_1.length; _i++) {\n        var observer = resetObservers_1[_i];\n        observer();\n    }\n});\nvar persistence;\nvar persistenceObservers = [];\nvar persistenceScale = [0, .6, .7, .8, .9];\nvar PERSISTENCE_CONTROL_ID = \"persistence-range-id\";\nPage.Range.addObserver(PERSISTENCE_CONTROL_ID, function (newValue) {\n    persistence = newValue;\n    for (var _i = 0, persistenceObservers_1 = persistenceObservers; _i < persistenceObservers_1.length; _i++) {\n        var observer = persistenceObservers_1[_i];\n        observer(persistence);\n    }\n});\npersistence = Page.Range.getValue(PERSISTENCE_CONTROL_ID);\nvar scale;\nvar exactScale;\nvar MIN_SCALE = 1;\nvar MAX_SCALE = 10;\nvar scaleObservers = [];\nPage.Canvas.Observers.mouseWheel.push(function (delta, zoomCenter) {\n    exactScale = Math.min(MAX_SCALE, Math.max(MIN_SCALE, exactScale - delta));\n    var newScale = Math.round(exactScale);\n    if (newScale !== scale) {\n        scale = newScale;\n        if (!zoomCenter) {\n            zoomCenter = Page.Canvas.getMousePosition();\n        }\n        for (var _i = 0, scaleObservers_1 = scaleObservers; _i < scaleObservers_1.length; _i++) {\n            var observer = scaleObservers_1[_i];\n            observer(scale, zoomCenter);\n        }\n    }\n});\nscale = MIN_SCALE;\nexactScale = scale;\nvar INDICATORS_CONTROL_ID = \"indicators-checkbox-id\";\nPage.Checkbox.addObserver(INDICATORS_CONTROL_ID, function (checked) {\n    Page.Canvas.setIndicatorsVisibility(checked);\n});\nvar Parameters = (function () {\n    function Parameters() {\n    }\n    Object.defineProperty(Parameters, \"autorun\", {\n        get: function () {\n            return autorun;\n        },\n        set: function (ar) {\n            autorun = ar;\n            Page.Checkbox.setChecked(AUTORUN_CONTROL_ID, ar);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"updateWaitTime\", {\n        get: function () {\n            return updateWaitTime[speed - 1];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"nextStepObservers\", {\n        get: function () {\n            return nextStepObservers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"resetObservers\", {\n        get: function () {\n            return resetObservers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"scale\", {\n        get: function () {\n            return scale;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"scaleObservers\", {\n        get: function () {\n            return scaleObservers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"persistence\", {\n        get: function () {\n            return persistenceScale[persistence];\n        },\n        set: function (newValue) {\n            Page.Range.setValue(PERSISTENCE_CONTROL_ID, newValue);\n            persistence = Page.Range.getValue(PERSISTENCE_CONTROL_ID);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"persistenceObservers\", {\n        get: function () {\n            return persistenceObservers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"rules\", {\n        get: function () {\n            return rules;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Parameters, \"rulesObservers\", {\n        get: function () {\n            return rulesObservers;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Parameters;\n}());\nexports.default = Parameters;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(633);\n"],"names":["extendStatics","__extends","this","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__createBinding","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","exports","fbo_1","gl_canvas_1","gl_resource_1","ShaderManager","vbo_1","parameters_1","Automaton2D","_super","_this","gl","_FBO","default","_vbo","createQuad","initializeTexturesForCanvas","canvasSize","Page","Canvas","getSize","initializeTextures","recomputeVisibleSubTexture","_needToRecomputeShader","_mustClear","_textures","_visibleSubTexture","Observers","mouseDrag","push","dX","dY","_needToRedraw","canvasResize","resetObservers","rulesObservers","previousScale","scale","scaleObservers","newScale","zoomCenter","buildShader","fragmentFilename","vertexFilename","injected","shader","_displayShader","a","VBO","u","freeGLResources","_updateShader","freeTextures","update","recomputeUpdateShader","current","_currentIndex","next","bind","_textureSize","use","bindUniformsAndAttributes","disable","BLEND","drawArrays","TRIANGLE_STRIP","_iteration","draw","persistence","_gridSize","enable","rules","generateShaderRules","generateRuleBlock","starting","ending","rule","rangeCheck","currentRule","from","i","Math","min","max","deleteTexture","width","height","upperPowerOfTwo","n","pow","ceil","log","LOG2E","physicalWidth","physicalHeight","data","Uint8Array","length","floor","random","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","setIndicatorText","FBO","id","createFramebuffer","bindDefault","viewport","bindFramebuffer","FRAMEBUFFER","drawingBufferWidth","drawingBufferHeight","left","lower","colorBuffers","depthBuffer","framebufferTexture2D","bindRenderbuffer","RENDERBUFFER","framebufferRenderbuffer","DEPTH_ATTACHMENT","deleteFramebuffer","initGL","adjustSize","flags","setError","message","Demopage","setErrorMessage","canvas","getCanvas","getContext","CULL_FACE","DEPTH_TEST","clearColor","hidpi","cssPixel","window","devicePixelRatio","clientWidth","clientHeight","GLResource","_gl","deleteShader","registerShader","getShader","shader_1","ShaderSources","cachedShaders","infos","callback","sourcesPending","sourcesFailed","loadedSource","success","processSource","source","replace","match","name","vert","getSource","frag","processedVert","processedFrag","loadSource","callAndClearCallbacks","cached","_i","_a","callbacks","cachedCallback","failed","pending","cached_1","builtShader","cachedSources","filename","text","xhr_1","XMLHttpRequest","open","onload","readyState","status","responseText","console","error","statusText","onerror","send","notImplemented","location","alert","types","str","binder","uniform2fv","uniform3fv","uniform4fv","uniform2iv","uniform3iv","uniform4iv","uniform1i","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","unitNb","activeTexture","TEXTURE_CUBE_MAP","isArray","uniform1iv","uniform1fv","uniform1f","ShaderProgram","vertexSource","fragmentSource","createShader","type","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","uCount","aCount","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","introspection","getProgramInfoLog","deleteProgram","useProgram","bindUniforms","currTextureUnitNb","keys","forEach","uName","uniform","loc","bindAttributes","aName","attribute","ACTIVE_UNIFORMS","getActiveUniform","name_1","getUniformLocation","size","ACTIVE_ATTRIBUTES","getActiveAttrib","name_2","getAttribLocation","array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","normalize","stride","offset","minX","minY","maxX","maxY","Float32Array","FLOAT","deleteBuffer","enableVertexAttribArray","vertexAttribPointer","Viewport","setFullCanvas","set","GlCanvas","viewport_1","automaton_2D_1","alpha","preserveDrawingBuffer","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","showLoader","needToAdjustSize","autorun","automaton","lastIteration","iteration","setInterval","forceUpdate","nextStepObservers","firstDraw","lastUpdate","requestAnimationFrame","mainLoop","time","needToUpdate","updateWaitTime","needToRedraw","main","Rule","DEFAULT_RULES","DEATH","ALIVE","BIRTH","slice","updateRuleControl","controlId","concat","Tabs","setValues","storeState","callRulesObservers","rulesObservers_1","observer","CUSTOM_RULE_FLAG","addEventListener","customRules","URLSearchParams","search","has","_loop_1","addObserver","values","previous","indexOf","searchParamsObject","searchParams","toString","newUrl","origin","pathname","history","replaceState","addCustomRulesUrlFlag","getValues","Button","somethingChanged","clearStoredState","delete","removeCustomRulesUrlFlag","speed","AUTORUN_CONTROL_ID","Checkbox","checked","isChecked","SPEED_CONTROL_ID","Range","newValue","getValue","nextStepObservers_1","resetObservers_1","exactScale","persistenceObservers","persistenceScale","PERSISTENCE_CONTROL_ID","persistenceObservers_1","mouseWheel","delta","round","getMousePosition","scaleObservers_1","setIndicatorsVisibility","Parameters","ar","setChecked","setValue","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__"],"sourceRoot":""}
!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this._gl=t}return t.prototype.gl=function(){return this._gl},t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=null;e.gl=n,e.initGL=function(t){function r(t){Demopage.setErrorMessage("webgl-support",t)}var i=Canvas.getCanvas();if(e.gl=n=i.getContext("webgl",t),null==n){if(e.gl=n=i.getContext("experimental-webgl",t),null==n)return r("Your browser or device does not seem to support WebGL."),!1;r("Your browser or device only supports experimental WebGL.\nThe simulation may not run as expected.")}return n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.BLEND),n.clearColor(0,0,0,1),!0},e.adjustSize=function(t){void 0===t&&(t=!1);var e=t?window.devicePixelRatio:1,r=Math.floor(n.canvas.clientWidth*e),i=Math.floor(n.canvas.clientHeight*e);n.canvas.width===r&&n.canvas.height===i||(n.canvas.width=r,n.canvas.height=i)}},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.id=e.createFramebuffer(),i.width=r,i.height=n,i}return i(e,t),e.bindDefault=function(t,e){void 0===e&&(e=null),t.bindFramebuffer(t.FRAMEBUFFER,null),null===e?t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight):t.viewport(e.left,e.lower,e.width,e.height)},e.prototype.bind=function(e,r){void 0===r&&(r=null);var n=t.prototype.gl.call(this);n.bindFramebuffer(n.FRAMEBUFFER,this.id),n.viewport(0,0,this.width,this.height);for(var i=0;i<e.length;++i)n.framebufferTexture2D(n.FRAMEBUFFER,n["COLOR_ATTACHMENT"+i],n.TEXTURE_2D,e[i],0);r&&(n.bindRenderbuffer(n.RENDERBUFFER,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,r))},e.prototype.freeGLResources=function(){t.prototype.gl.call(this).deleteFramebuffer(this.id),this.id=null},e}(o(r(0)).default);e.default=u},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(2)),u=i(r(1)),a=r(1),s=n(r(4)),l=n(r(5)),f=n(r(10));!function(){if(u.initGL({alpha:!1})){Canvas.showLoader(!0),f.default.autorun=!0;var t=new l.default;requestAnimationFrame(function e(){f.default.autorun&&t.update(),(f.default.autorun||t.needToRedraw)&&(Canvas.setIndicatorText("Iteration",t.iteration),o.default.bindDefault(a.gl),u.adjustSize(),s.default.setFullCanvas(a.gl),a.gl.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT),t.draw()),requestAnimationFrame(e)})}}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,r,n){this.left=t,this.lower=e,this.width=r,this.height=n}return t.setFullCanvas=function(t){t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)},t.prototype.set=function(t){t.viewport(this.lower,this.left,this.width,this.height)},t}();e.default=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=o(r(2)),s=r(1),l=o(r(0)),f=o(r(6)),d=u(r(7)),c=function(t){function e(){var e=t.call(this,s.gl)||this;return e._FBO=new a.default(s.gl,512,512),e._vbo=f.default.createQuad(s.gl,-1,-1,1,1),e._textures=[null,null],e.initializeTextures(512,512),Button.addObserver("reset-button-id",function(){e.initializeTextures(512,512)}),d.buildShader({fragmentFilename:"display-2D.frag",vertexFilename:"display-2D.vert"},function(t){null!==t&&(e._displayShader=t,e._displayShader.a.aCorner.VBO=e._vbo)}),d.buildShader({fragmentFilename:"update-2D.frag",vertexFilename:"fullscreen.vert"},function(t){null!==t&&(e._updateShader=t,e._updateShader.a.aCorner.VBO=e._vbo)}),e}return i(e,t),e.prototype.freeGLResources=function(){this._FBO&&this._FBO.freeGLResources(),this._vbo&&(this._vbo.freeGLResources(),this._vbo=null),this._displayShader&&(this._displayShader.freeGLResources(),this._displayShader=null),this._updateShader&&(this._updateShader.freeGLResources(),this._updateShader=null),this.freeTextures()},e.prototype.update=function(){var t=this._updateShader;if(t){var e=this._textures[this._currentIndex],r=this._textures[(this._currentIndex+1)%2];this._FBO.bind([r]),t.u.uPrevious.value=e,t.u.uCellSize.value=[1/this._textureSize[0],1/this._textureSize[1]],t.use(),t.bindUniformsAndAttributes(),s.gl.drawArrays(s.gl.TRIANGLE_STRIP,0,4),this._currentIndex=(this._currentIndex+1)%2,this._iteration++}},e.prototype.draw=function(){var t=this._displayShader;t&&(t.u.uTexture.value=this._textures[this._currentIndex],t.use(),t.bindUniformsAndAttributes(),s.gl.drawArrays(s.gl.TRIANGLE_STRIP,0,4),Canvas.showLoader(!1),this._needToRedraw=!1)},Object.defineProperty(e.prototype,"iteration",{get:function(){return this._iteration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needToRedraw",{get:function(){return this._needToRedraw},enumerable:!0,configurable:!0}),e.prototype.freeTextures=function(){for(var t=0;t<2;++t)this._textures[t]&&(s.gl.deleteTexture(this._textures[t]),this._textures[t]=null)},e.prototype.initializeTextures=function(t,e){function r(t){return Math.pow(2,Math.ceil(Math.log(t)*Math.LOG2E))}t=r(t),e=r(e),this._FBO.width=t,this._FBO.height=e,this._textureSize=[t,e],this.freeTextures();for(var n=new Uint8Array(4*t*e),i=t*e;i>0;--i){var o=255*Math.round(Math.random());n[4*i+0]=o,n[4*i+1]=o,n[4*i+2]=o,n[4*i+3]=255}for(i=0;i<2;++i)this._textures[i]=s.gl.createTexture(),s.gl.bindTexture(s.gl.TEXTURE_2D,this._textures[i]),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,t,e,0,s.gl.RGBA,s.gl.UNSIGNED_BYTE,n),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MAG_FILTER,s.gl.NEAREST),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MIN_FILTER,s.gl.NEAREST);this._currentIndex=0,this._iteration=0,this._needToRedraw=!0},e}(l.default);e.default=c},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.id=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o.id),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),o.size=n,o.type=i,o.normalize=!1,o.stride=0,o.offset=0,o}return i(e,t),e.createQuad=function(t,r,n,i,o){return new e(t,new Float32Array([r,n,i,n,r,o,i,o]),2,t.FLOAT)},e.prototype.freeGLResources=function(){this.gl().deleteBuffer(this.id),this.id=null},e.prototype.bind=function(e){var r=t.prototype.gl.call(this);r.enableVertexAttribArray(e),r.bindBuffer(r.ARRAY_BUFFER,this.id),r.vertexAttribPointer(e,this.size,this.type,this.normalize,this.stride,this.offset)},e}(o(r(0)).default);e.default=u},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),u=n(r(8)),a=i(r(9)),s={};function l(t,e){var r=2,n=0;function i(i){if(i||n++,0===--r){var s=null;if(0===n){var l=a.getSource(t.vertexFilename),f=a.getSource(t.fragmentFilename);s=new u.default(o.gl,l,f)}e(s)}}a.loadSource(t.vertexFilename,i),a.loadSource(t.fragmentFilename,i)}e.getShader=function(t){return s[t].shader},e.buildShader=l,e.registerShader=function(t,e,r){function n(t){for(var e=0,r=t.callbacks;e<r.length;e++)(0,r[e])(!t.failed,t.shader);t.callbacks=[]}if(void 0===s[t]){s[t]={callbacks:[r],failed:!1,infos:e,pending:!0,shader:null};var i=s[t];l(e,function(t){i.pending=!1,i.failed=null===t,i.shader=t,n(i)})}else{var o=s[t];!0===o.pending?o.callbacks.push(r):n(o)}},e.deleteShader=function(t){s[t]&&(s[t].shader&&s[t].shader.freeGLResources(),delete s[t])}},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=o(r(0));function a(t,e,r){alert("NOT IMPLEMENTED YET")}var s={35664:{str:"FLOAT_VEC2",binder:function(t,e,r){t.uniform2fv(e,r)}},35665:{str:"FLOAT_VEC3",binder:function(t,e,r){t.uniform3fv(e,r)}},35666:{str:"FLOAT_VEC4",binder:function(t,e,r){t.uniform4fv(e,r)}},35667:{str:"INT_VEC2",binder:function(t,e,r){t.uniform2iv(e,r)}},35668:{str:"INT_VEC3",binder:function(t,e,r){t.uniform3iv(e,r)}},35669:{str:"INT_VEC4",binder:function(t,e,r){t.uniform4iv(e,r)}},35670:{str:"BOOL",binder:function(t,e,r){t.uniform1i(e,+r)}},35671:{str:"BOOL_VEC2",binder:function(t,e,r){t.uniform2iv(e,r)}},35672:{str:"BOOL_VEC3",binder:function(t,e,r){t.uniform3iv(e,r)}},35673:{str:"BOOL_VEC4",binder:function(t,e,r){t.uniform4iv(e,r)}},35674:{str:"FLOAT_MAT2",binder:function(t,e,r){t.uniformMatrix2fv(e,!1,r)}},35675:{str:"FLOAT_MAT3",binder:function(t,e,r){t.uniformMatrix3fv(e,!1,r)}},35676:{str:"FLOAT_MAT4",binder:function(t,e,r){t.uniformMatrix4fv(e,!1,r)}},35678:{str:"SAMPLER_2D",binder:function(t,e,r,n){t.uniform1i(e,r),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,n)}},35680:{str:"SAMPLER_CUBE",binder:function(t,e,r,n){t.uniform1i(e,r),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_CUBE_MAP,n)}},5120:{str:"BYTE",binder:a},5121:{str:"UNSIGNED_BYTE",binder:a},5122:{str:"SHORT",binder:a},5123:{str:"UNSIGNED_SHORT",binder:a},5124:{str:"INT",binder:function(t,e,r){Array.isArray(r),t.uniform1iv(e,r)}},5125:{str:"UNSIGNED_INT",binder:a},5126:{str:"FLOAT",binder:function(t,e,r){Array.isArray(r)?t.uniform1fv(e,r):t.uniform1f(e,r)}}},l=function(t){function e(e,r,n){var i=this;function o(t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.error(e.getShaderInfoLog(n)),e.deleteShader(n),null)}(i=t.call(this,e)||this).id=null,i.uCount=0,i.aCount=0;var u=o(e.VERTEX_SHADER,r),a=o(e.FRAGMENT_SHADER,n),s=e.createProgram();return e.attachShader(s,u),e.attachShader(s,a),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?(i.id=s,i.introspection()):(console.error(e.getProgramInfoLog(s)),e.deleteProgram(s)),i}return i(e,t),e.prototype.freeGLResources=function(){t.prototype.gl.call(this).deleteProgram(this.id),this.id=null},e.prototype.use=function(){t.prototype.gl.call(this).useProgram(this.id)},e.prototype.bindUniforms=function(){var e=this,r=t.prototype.gl.call(this),n=0;Object.keys(this.u).forEach(function(t){var i=e.u[t];if(null!==i.value)if(35678===i.type||35680===i.type){var o=n;s[i.type].binder(r,i.loc,o,i.value),n++}else s[i.type].binder(r,i.loc,i.value)})},e.prototype.bindAttributes=function(){var t=this;Object.keys(this.a).forEach(function(e){var r=t.a[e];null!==r.VBO&&r.VBO.bind(r.loc)})},e.prototype.bindUniformsAndAttributes=function(){this.bindUniforms(),this.bindAttributes()},e.prototype.introspection=function(){var e=t.prototype.gl.call(this);this.uCount=e.getProgramParameter(this.id,e.ACTIVE_UNIFORMS),this.u=[];for(var r=0;r<this.uCount;++r){var n=e.getActiveUniform(this.id,r),i=n.name;this.u[i]={loc:e.getUniformLocation(this.id,i),size:n.size,type:n.type,value:null}}this.aCount=e.getProgramParameter(this.id,e.ACTIVE_ATTRIBUTES),this.a=[];for(r=0;r<this.aCount;++r){var o=e.getActiveAttrib(this.id,r),u=o.name;this.a[u]={VBO:null,loc:e.getAttribLocation(this.id,u),size:o.size,type:o.type}}},e}(u.default);e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};e.loadSource=function(t,e){function r(t){for(var e=0,r=t.callbacks;e<r.length;e++)(0,r[e])(!t.failed);t.callbacks=[]}if(void 0===n[t]){n[t]={callbacks:[e],failed:!1,pending:!0,text:null};var i=n[t],o=new XMLHttpRequest;o.open("GET","./shaders/"+t,!0),o.onload=function(){4===o.readyState&&(i.pending=!1,200===o.status?(i.text=o.responseText,i.failed=!1):(console.error("Cannot load '"+t+"' shader source: "+o.statusText),i.failed=!0),r(i))},o.onerror=function(){console.error("Cannot load '"+t+"' shader source: "+o.statusText),i.pending=!1,i.failed=!0,r(i)},o.send(null)}else{var u=n[t];!0===u.pending?u.callbacks.push(e):r(u)}},e.getSource=function(t){return n[t].text}},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0});Button.addObserver("stop-start-button-id",function(){i.autorun=!n});var i=function(){function t(){}return Object.defineProperty(t,"autorun",{get:function(){return n},set:function(t){n=t,Button.setLabel("stop-start-button-id",n?"Stop":"Start")},enumerable:!0,configurable:!0}),t}();e.default=i}]);